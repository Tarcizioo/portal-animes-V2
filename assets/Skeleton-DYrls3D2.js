import{j as u,a as nn}from"./index-CPSkf6_A.js";import{O as $n,z as rn,ab as qn,ac as Xn,i as on,q as Yn,S as Wn,Z as Kn,X as Hn,m as B,G as Vn,N as Gn,ad as _n,H as Ut,a1 as Jn,Q as Qn,ae as Zn,af as er,P as tr,ag as nr}from"./ui-DGQG60Ii.js";import{r as c,R as O,e as Me,L as rr}from"./vendor-CzuZ2vSz.js";import{u as or}from"./useAnimeLibrary-thLaFgu-.js";import{a as Ct}from"./usePageTitle-XJJnLCUf.js";function is({user:e,profile:t,onEdit:n,onShare:r,readOnly:o=!1}){const s=t?.bannerURL||e?.bannerURL||"https://placehold.co/1200x400/1a1a1a/FFF?text=Banner+Anime",a=t?.photoURL||e?.photoURL||"https://placehold.co/200x200/6366f1/FFF?text=User",i=t?.displayName||e?.displayName||"UsuÃ¡rio";return u.jsxs("div",{className:"relative mb-32 md:mb-20",children:[u.jsxs("div",{className:"h-48 md:h-72 w-full rounded-3xl overflow-hidden relative shadow-2xl group",children:[u.jsx("img",{src:s,alt:"Banner",className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"}),u.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background-light dark:from-background-dark via-transparent to-black/30 opacity-90"}),u.jsx("div",{className:"absolute top-4 right-4 md:top-6 md:right-6 flex gap-2",children:u.jsxs("span",{className:"bg-black/40 backdrop-blur-md text-white px-3 py-1 rounded-full text-xs font-medium border border-white/10 flex items-center gap-1",children:[u.jsx("span",{className:"w-2 h-2 rounded-full bg-green-400"})," ","Online"]})})]}),u.jsxs("div",{className:"absolute -bottom-24 left-0 right-0 md:-bottom-16 md:left-12 md:right-auto flex flex-col md:flex-row items-center md:items-end gap-4 md:gap-6 px-4 md:px-0",children:[u.jsxs("div",{className:"group relative",children:[u.jsx("div",{className:"w-32 h-32 md:w-36 md:h-36 rounded-full p-1.5 bg-background-light dark:bg-background-dark shadow-2xl",children:u.jsx("img",{src:a,alt:i,className:"w-full h-full rounded-full object-cover border-4 border-white dark:border-[#1e1e24]"})}),!o&&u.jsxs("div",{className:"absolute bottom-1 right-1 md:bottom-2 md:right-2 flex gap-2 z-10",children:[u.jsx("button",{onClick:r,className:"p-2 bg-bg-tertiary text-text-primary rounded-full shadow-lg hover:bg-bg-secondary transition-all transform hover:scale-110 cursor-pointer border border-border-color",title:"Compartilhar Perfil",children:u.jsx($n,{className:"w-4 h-4"})}),u.jsx("button",{onClick:n,className:"p-2 bg-primary text-white rounded-full shadow-lg hover:bg-primary-hover transition-all transform hover:scale-110 cursor-pointer",title:"Editar Perfil",children:u.jsx(rn,{className:"w-4 h-4"})})]})]}),u.jsxs("div",{className:"mb-0 md:mb-4 space-y-1 text-center md:text-left",children:[u.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-[var(--text-primary)]",children:i}),u.jsxs("p",{className:"text-gray-400 text-sm",children:["Membro desde ",new Date().getFullYear()]})]})]})]})}const Te=[{id:"first_step",name:"Primeiro Passo",description:"Adicionou o primeiro anime Ã  biblioteca.",icon:qn,color:"text-blue-400",bg:"bg-blue-500/10",border:"border-blue-500/20",requirement:e=>e.totalAnimes>=1},{id:"otaku_initiate",name:"Iniciado",description:"Completou 5 animes.",icon:Xn,color:"text-green-400",bg:"bg-green-500/10",border:"border-green-500/20",requirement:e=>e.completedAnimes>=5},{id:"veteran",name:"Veterano",description:"Completou 20 animes.",icon:on,color:"text-yellow-400",bg:"bg-yellow-500/10",border:"border-yellow-500/20",requirement:e=>e.completedAnimes>=20},{id:"marathonist",name:"Maratonista",description:"Assistiu a 100 episÃ³dios.",icon:Yn,color:"text-red-400",bg:"bg-red-500/10",border:"border-red-500/20",requirement:e=>e.episodesWatched>=100},{id:"critic",name:"CrÃ­tico",description:"Avaliou 5 animes.",icon:Wn,color:"text-purple-400",bg:"bg-purple-500/10",border:"border-purple-500/20",requirement:(e,t)=>t.filter(n=>n.score>0).length>=5},{id:"collector",name:"Colecionador",description:"Tem 10+ animes na lista.",icon:Kn,color:"text-orange-400",bg:"bg-orange-500/10",border:"border-orange-500/20",requirement:e=>e.totalAnimes>=10}];function sn(){const{library:e}=or();Ct();const{toast:t}=nn(),n=c.useMemo(()=>{if(!e)return{totalAnimes:0,completedAnimes:0,episodesWatched:0};const a=e.length,i=e.filter(d=>d.status==="completed").length,l=e.reduce((d,g)=>d+(g.currentEp||0),0);return{totalAnimes:a,completedAnimes:i,episodesWatched:l}},[e]),{unlockedBadges:r,lockedBadges:o}=c.useMemo(()=>{const a=[],i=[];return Te.forEach(l=>{l.requirement(n,e)?a.push(l):i.push(l)}),{unlockedBadges:a,lockedBadges:i}},[n,e]);c.useEffect(()=>{if(r.length>0){const a=JSON.parse(localStorage.getItem("known_badges")||"[]");let i=!1;r.forEach(l=>{a.includes(l.id)||(t.success(`Conquista Desbloqueada: ${l.name}!`,"ParabÃ©ns!"),a.push(l.id),i=!0)}),i&&localStorage.setItem("known_badges",JSON.stringify(a))}},[r,t]);const s=o.length>0?o[0]:null;return{stats:n,unlockedBadges:r,lockedBadges:o,nextBadge:s,totalBadges:Te.length,progressPercentage:Math.round(r.length/Te.length*100)}}function sr({isOpen:e,onClose:t}){if(!e)return null;const{unlockedBadges:n,lockedBadges:r}=sn(),{profile:o,updateProfileData:s}=Ct(),{toast:a}=nn(),i=[...n,...r],[l,d]=c.useState([]),[g,f]=c.useState(!1);c.useEffect(()=>{o?.featuredBadges?d(o.featuredBadges):d(n.slice(0,3).map(b=>b.id))},[o,n]);const h=b=>{n.some(v=>v.id===b)&&d(v=>v.includes(b)?v.filter(y=>y!==b):v.length>=3?(a.warning("VocÃª sÃ³ pode fixar atÃ© 3 conquistas."),v):[...v,b])},p=async()=>{f(!0);try{await s({featuredBadges:l}),a.success("Conquistas fixadas atualizadas!"),t()}catch{a.error("Erro ao salvar conquistas.")}finally{f(!1)}};return u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:u.jsxs("div",{className:"bg-[var(--bg-secondary)] w-full max-w-2xl rounded-2xl border border-[var(--border-color)] shadow-2xl overflow-hidden flex flex-col max-h-[85vh]",children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-[var(--border-color)] bg-[var(--bg-tertiary)]",children:[u.jsxs("div",{className:"flex flex-col",children:[u.jsxs("h2",{className:"text-xl font-bold text-[var(--text-primary)] flex items-center gap-2",children:[u.jsx(on,{className:"w-5 h-5 text-yellow-500"})," Gerenciar Conquistas"]}),u.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"Fixe atÃ© 3 conquistas no seu perfil"})]}),u.jsx("button",{onClick:t,className:"p-2 hover:bg-[var(--bg-primary)]/10 rounded-full transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)]",children:u.jsx(Hn,{className:"w-5 h-5"})})]}),u.jsx("div",{className:"overflow-y-auto p-6 scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-transparent",children:u.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:i.map(b=>{const m=n.some(w=>w.id===b.id),v=l.includes(b.id),y=b.icon;return u.jsxs("div",{onClick:()=>h(b.id),className:B("relative border rounded-xl p-4 flex flex-col items-center gap-3 transition-all cursor-pointer select-none",m?v?"bg-primary/10 border-primary shadow-[0_0_15px_rgba(var(--primary-rgb),0.3)] transform scale-105":"bg-white/5 border-white/10 hover:border-white/30 hover:bg-white/10":"opacity-50 grayscale cursor-not-allowed bg-black/20 border-white/5"),children:[u.jsx("div",{className:B("w-12 h-12 rounded-full flex items-center justify-center transition-transform",m?b.bg:"bg-gray-800",v&&"scale-110"),children:m?u.jsx(y,{className:B("w-6 h-6",b.color)}):u.jsx(Vn,{className:"w-5 h-5 text-gray-500"})}),u.jsxs("div",{className:"text-center",children:[u.jsx("h4",{className:B("text-sm font-bold mb-1",m?"text-[var(--text-primary)]":"text-gray-500"),children:b.name}),u.jsx("p",{className:"text-[10px] text-[var(--text-secondary)] leading-tight line-clamp-2",children:b.description})]}),v&&u.jsx("div",{className:"absolute top-2 right-2 w-3 h-3 bg-primary rounded-full shadow-lg shadow-primary/50 animate-pulse"})]},b.id)})})}),u.jsxs("div",{className:"p-6 border-t border-[var(--border-color)] bg-[var(--bg-tertiary)] flex justify-between items-center gap-3",children:[u.jsxs("span",{className:"text-sm font-medium text-[var(--text-secondary)]",children:[l.length,"/3 Selecionadas"]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:t,className:"px-6 py-2.5 rounded-xl border border-[var(--border-color)] text-[var(--text-secondary)] hover:bg-[var(--bg-primary)]/10 hover:text-[var(--text-primary)] transition-all font-medium",children:"Cancelar"}),u.jsx("button",{disabled:g,onClick:p,className:"px-6 py-2.5 rounded-xl bg-primary text-white font-bold hover:bg-primary-hover shadow-lg shadow-primary/20 hover:scale-105 active:scale-95 transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Salvando...":u.jsxs(u.Fragment,{children:[u.jsx(Gn,{className:"w-4 h-4"})," Salvar"]})})]})]})]})})}function as(){const{unlockedBadges:e}=sn(),{profile:t}=Ct(),[n,r]=c.useState(!1),o=e.length,s=Te.length,a=Math.round(o/s*100);let i=[];return t?.featuredBadges&&t.featuredBadges.length>0?i=t.featuredBadges.map(l=>Te.find(d=>d.id===l)).filter(Boolean):i=e.slice(0,3),u.jsxs("div",{className:"bg-[var(--bg-secondary)] border border-[var(--border-color)] rounded-2xl p-6 space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-2xl",children:"ðŸ†"}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-[var(--text-primary)] text-lg leading-none",children:"Conquistas"}),u.jsxs("span",{className:"text-xs text-[var(--text-secondary)] font-medium",children:[o," de ",s," desbloqueadas"]})]})]}),u.jsxs("button",{onClick:()=>r(!0),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-[var(--bg-primary)] hover:bg-primary/20 hover:text-primary text-[var(--text-secondary)] transition-all group border border-transparent hover:border-primary/30",title:"Gerenciar Conquistas",children:[u.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Editar"}),u.jsx(rn,{className:"w-4 h-4"})]})]}),u.jsx("div",{className:"w-full bg-[var(--bg-primary)]/50 rounded-full h-1.5 overflow-hidden",children:u.jsx("div",{className:"bg-gradient-to-r from-primary to-purple-500 h-full rounded-full transition-all duration-1000",style:{width:`${a}%`}})}),u.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[i.length>0?i.map(l=>{const d=l.icon;return u.jsxs("div",{className:B("relative group flex flex-col items-center justify-center p-3 rounded-xl border transition-all duration-300 bg-black/20 hover:bg-[var(--bg-primary)]/10",l.border),children:[u.jsx("div",{className:B("w-10 h-10 rounded-full flex items-center justify-center mb-2",l.bg),children:u.jsx(d,{className:B("w-5 h-5",l.color)})}),u.jsx("h4",{className:"text-[10px] font-bold text-center text-[var(--text-primary)] leading-tight line-clamp-1",children:l.name})]},l.id)}):u.jsx("div",{className:"col-span-3 py-4 text-center text-sm text-[var(--text-secondary)] italic bg-black/20 rounded-xl border border-[var(--border-color)] border-dashed",children:"Ainda sem conquistas desbloqueadas."}),i.length<3&&e.length>i.length&&u.jsxs("button",{onClick:()=>r(!0),className:"flex flex-col items-center justify-center p-3 rounded-xl border border-[var(--border-color)] border-dashed hover:border-primary/50 hover:bg-primary/5 transition-all group",children:[u.jsx(_n,{className:"w-8 h-8 text-[var(--text-secondary)] group-hover:text-primary mb-1 transition-colors"}),u.jsx("span",{className:"text-[10px] font-medium text-[var(--text-secondary)] group-hover:text-primary",children:"Fixar"})]})]}),u.jsx(sr,{isOpen:n,onClose:()=>r(!1)})]})}function ir(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.useMemo(()=>r=>{t.forEach(o=>o(r))},t)}const st=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Se(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function St(e){return"nodeType"in e}function z(e){var t,n;return e?Se(e)?e:St(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Dt(e){const{Document:t}=z(e);return e instanceof t}function $e(e){return Se(e)?!1:e instanceof z(e).HTMLElement}function an(e){return e instanceof z(e).SVGElement}function De(e){return e?Se(e)?e.document:St(e)?Dt(e)?e:$e(e)||an(e)?e.ownerDocument:document:document:document}const J=st?c.useLayoutEffect:c.useEffect;function it(e){const t=c.useRef(e);return J(()=>{t.current=e}),c.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.current==null?void 0:t.current(...r)},[])}function ar(){const e=c.useRef(null),t=c.useCallback((r,o)=>{e.current=setInterval(r,o)},[]),n=c.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function ze(e,t){t===void 0&&(t=[e]);const n=c.useRef(e);return J(()=>{n.current!==e&&(n.current=e)},t),n}function qe(e,t){const n=c.useRef();return c.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function Ze(e){const t=it(e),n=c.useRef(null),r=c.useCallback(o=>{o!==n.current&&t?.(o,n.current),n.current=o},[]);return[n,r]}function et(e){const t=c.useRef();return c.useEffect(()=>{t.current=e},[e]),t.current}let ht={};function Xe(e,t){return c.useMemo(()=>{if(t)return t;const n=ht[e]==null?0:ht[e]+1;return ht[e]=n,e+"-"+n},[e,t])}function ln(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((s,a)=>{const i=Object.entries(a);for(const[l,d]of i){const g=s[l];g!=null&&(s[l]=g+e*d)}return s},{...t})}}const Ce=ln(1),Fe=ln(-1);function lr(e){return"clientX"in e&&"clientY"in e}function at(e){if(!e)return!1;const{KeyboardEvent:t}=z(e.target);return t&&e instanceof t}function cr(e){if(!e)return!1;const{TouchEvent:t}=z(e.target);return t&&e instanceof t}function tt(e){if(cr(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return lr(e)?{x:e.clientX,y:e.clientY}:null}const he=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[he.Translate.toString(e),he.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),$t="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function dr(e){return e.matches($t)?e:e.querySelector($t)}const ur={display:"none"};function fr(e){let{id:t,value:n}=e;return O.createElement("div",{id:t,style:ur},n)}function gr(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return O.createElement("div",{id:t,style:o,role:"status","aria-live":r,"aria-atomic":!0},n)}function hr(){const[e,t]=c.useState("");return{announce:c.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const cn=c.createContext(null);function pr(e){const t=c.useContext(cn);c.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function vr(){const[e]=c.useState(()=>new Set),t=c.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[c.useCallback(r=>{let{type:o,event:s}=r;e.forEach(a=>{var i;return(i=a[o])==null?void 0:i.call(a,s)})},[e]),t]}const br={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},mr={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function xr(e){let{announcements:t=mr,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=br}=e;const{announce:s,announcement:a}=hr(),i=Xe("DndLiveRegion"),[l,d]=c.useState(!1);if(c.useEffect(()=>{d(!0)},[]),pr(c.useMemo(()=>({onDragStart(f){let{active:h}=f;s(t.onDragStart({active:h}))},onDragMove(f){let{active:h,over:p}=f;t.onDragMove&&s(t.onDragMove({active:h,over:p}))},onDragOver(f){let{active:h,over:p}=f;s(t.onDragOver({active:h,over:p}))},onDragEnd(f){let{active:h,over:p}=f;s(t.onDragEnd({active:h,over:p}))},onDragCancel(f){let{active:h,over:p}=f;s(t.onDragCancel({active:h,over:p}))}}),[s,t])),!l)return null;const g=O.createElement(O.Fragment,null,O.createElement(fr,{id:r,value:o.draggable}),O.createElement(gr,{id:i,announcement:a}));return n?Me.createPortal(g,n):g}var M;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(M||(M={}));function nt(){}function qt(e,t){return c.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function yr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const Q=Object.freeze({x:0,y:0});function dn(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function wr(e,t){const n=tt(e);if(!n)return"0 0";const r={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return r.x+"% "+r.y+"%"}function un(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function Cr(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function Xt(e){let{left:t,top:n,height:r,width:o}=e;return[{x:t,y:n},{x:t+o,y:n},{x:t,y:n+r},{x:t+o,y:n+r}]}function fn(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Yt(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Sr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=Yt(t,t.left,t.top),s=[];for(const a of r){const{id:i}=a,l=n.get(i);if(l){const d=dn(Yt(l),o);s.push({id:i,data:{droppableContainer:a,value:d}})}}return s.sort(un)},Dr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=Xt(t),s=[];for(const a of r){const{id:i}=a,l=n.get(i);if(l){const d=Xt(l),g=o.reduce((h,p,b)=>h+dn(d[b],p),0),f=Number((g/4).toFixed(4));s.push({id:i,data:{droppableContainer:a,value:f}})}}return s.sort(un)};function Nr(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),a=o-r,i=s-n;if(r<o&&n<s){const l=t.width*t.height,d=e.width*e.height,g=a*i,f=g/(l+d-g);return Number(f.toFixed(4))}return 0}const Rr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const s of r){const{id:a}=s,i=n.get(a);if(i){const l=Nr(i,t);l>0&&o.push({id:a,data:{droppableContainer:s,value:l}})}}return o.sort(Cr)};function Er(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function gn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Q}function jr(e){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return o.reduce((a,i)=>({...a,top:a.top+e*i.y,bottom:a.bottom+e*i.y,left:a.left+e*i.x,right:a.right+e*i.x}),{...n})}}const Ar=jr(1);function hn(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function kr(e,t,n){const r=hn(t);if(!r)return e;const{scaleX:o,scaleY:s,x:a,y:i}=r,l=e.left-a-(1-o)*parseFloat(n),d=e.top-i-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),g=o?e.width/o:e.width,f=s?e.height/s:e.height;return{width:g,height:f,top:d,right:l+g,bottom:d+f,left:l}}const Or={ignoreTransform:!1};function Ne(e,t){t===void 0&&(t=Or);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:g}=z(e).getComputedStyle(e);d&&(n=kr(n,d,g))}const{top:r,left:o,width:s,height:a,bottom:i,right:l}=n;return{top:r,left:o,width:s,height:a,bottom:i,right:l}}function Wt(e){return Ne(e,{ignoreTransform:!0})}function Ir(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Mr(e,t){return t===void 0&&(t=z(e).getComputedStyle(e)),t.position==="fixed"}function Tr(e,t){t===void 0&&(t=z(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const s=t[o];return typeof s=="string"?n.test(s):!1})}function lt(e,t){const n=[];function r(o){if(t!=null&&n.length>=t||!o)return n;if(Dt(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!$e(o)||an(o)||n.includes(o))return n;const s=z(e).getComputedStyle(o);return o!==e&&Tr(o,s)&&n.push(o),Mr(o,s)?n:r(o.parentNode)}return e?r(e):n}function pn(e){const[t]=lt(e,1);return t??null}function pt(e){return!st||!e?null:Se(e)?e:St(e)?Dt(e)||e===De(e).scrollingElement?window:$e(e)?e:null:null}function vn(e){return Se(e)?e.scrollX:e.scrollLeft}function bn(e){return Se(e)?e.scrollY:e.scrollTop}function mt(e){return{x:vn(e),y:bn(e)}}var T;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(T||(T={}));function mn(e){return!st||!e?!1:e===document.scrollingElement}function xn(e){const t={x:0,y:0},n=mn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,i=e.scrollLeft>=r.x;return{isTop:o,isLeft:s,isBottom:a,isRight:i,maxScroll:r,minScroll:t}}const Lr={x:.2,y:.2};function Pr(e,t,n,r,o){let{top:s,left:a,right:i,bottom:l}=n;r===void 0&&(r=10),o===void 0&&(o=Lr);const{isTop:d,isBottom:g,isLeft:f,isRight:h}=xn(e),p={x:0,y:0},b={x:0,y:0},m={height:t.height*o.y,width:t.width*o.x};return!d&&s<=t.top+m.height?(p.y=T.Backward,b.y=r*Math.abs((t.top+m.height-s)/m.height)):!g&&l>=t.bottom-m.height&&(p.y=T.Forward,b.y=r*Math.abs((t.bottom-m.height-l)/m.height)),!h&&i>=t.right-m.width?(p.x=T.Forward,b.x=r*Math.abs((t.right-m.width-i)/m.width)):!f&&a<=t.left+m.width&&(p.x=T.Backward,b.x=r*Math.abs((t.left+m.width-a)/m.width)),{direction:p,speed:b}}function Br(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:a}=window;return{top:0,left:0,right:s,bottom:a,width:s,height:a}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function yn(e){return e.reduce((t,n)=>Ce(t,mt(n)),Q)}function zr(e){return e.reduce((t,n)=>t+vn(n),0)}function Fr(e){return e.reduce((t,n)=>t+bn(n),0)}function wn(e,t){if(t===void 0&&(t=Ne),!e)return;const{top:n,left:r,bottom:o,right:s}=t(e);pn(e)&&(o<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Ur=[["x",["left","right"],zr],["y",["top","bottom"],Fr]];class Nt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=lt(n),o=yn(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,a,i]of Ur)for(const l of a)Object.defineProperty(this,l,{get:()=>{const d=i(r),g=o[s]-d;return this.rect[l]+g},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Le{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var o;(o=this.target)==null||o.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function $r(e){const{EventTarget:t}=z(e);return e instanceof t?e:De(e)}function vt(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var _;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(_||(_={}));function Kt(e){e.preventDefault()}function qr(e){e.stopPropagation()}var E;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(E||(E={}));const Cn={start:[E.Space,E.Enter],cancel:[E.Esc],end:[E.Space,E.Enter,E.Tab]},Xr=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case E.Right:return{...n,x:n.x+25};case E.Left:return{...n,x:n.x-25};case E.Down:return{...n,y:n.y+25};case E.Up:return{...n,y:n.y-25}}};class Rt{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Le(De(n)),this.windowListeners=new Le(z(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(_.Resize,this.handleCancel),this.windowListeners.add(_.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(_.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&wn(r),n(Q)}handleKeyDown(t){if(at(t)){const{active:n,context:r,options:o}=this.props,{keyboardCodes:s=Cn,coordinateGetter:a=Xr,scrollBehavior:i="smooth"}=o,{code:l}=t;if(s.end.includes(l)){this.handleEnd(t);return}if(s.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:d}=r.current,g=d?{x:d.left,y:d.top}:Q;this.referenceCoordinates||(this.referenceCoordinates=g);const f=a(t,{active:n,context:r.current,currentCoordinates:g});if(f){const h=Fe(f,g),p={x:0,y:0},{scrollableAncestors:b}=r.current;for(const m of b){const v=t.code,{isTop:y,isRight:w,isLeft:C,isBottom:R,maxScroll:x,minScroll:N}=xn(m),S=Br(m),D={x:Math.min(v===E.Right?S.right-S.width/2:S.right,Math.max(v===E.Right?S.left:S.left+S.width/2,f.x)),y:Math.min(v===E.Down?S.bottom-S.height/2:S.bottom,Math.max(v===E.Down?S.top:S.top+S.height/2,f.y))},k=v===E.Right&&!w||v===E.Left&&!C,I=v===E.Down&&!R||v===E.Up&&!y;if(k&&D.x!==f.x){const j=m.scrollLeft+h.x,U=v===E.Right&&j<=x.x||v===E.Left&&j>=N.x;if(U&&!h.y){m.scrollTo({left:j,behavior:i});return}U?p.x=m.scrollLeft-j:p.x=v===E.Right?m.scrollLeft-x.x:m.scrollLeft-N.x,p.x&&m.scrollBy({left:-p.x,behavior:i});break}else if(I&&D.y!==f.y){const j=m.scrollTop+h.y,U=v===E.Down&&j<=x.y||v===E.Up&&j>=N.y;if(U&&!h.x){m.scrollTo({top:j,behavior:i});return}U?p.y=m.scrollTop-j:p.y=v===E.Down?m.scrollTop-x.y:m.scrollTop-N.y,p.y&&m.scrollBy({top:-p.y,behavior:i});break}}this.handleMove(t,Ce(Fe(f,this.referenceCoordinates),p))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Rt.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=Cn,onActivation:o}=t,{active:s}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const i=s.activatorNode.current;return i&&e.target!==i?!1:(e.preventDefault(),o?.({event:e.nativeEvent}),!0)}return!1}}];function Ht(e){return!!(e&&"distance"in e)}function Vt(e){return!!(e&&"delay"in e)}class Et{constructor(t,n,r){var o;r===void 0&&(r=$r(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:s}=t,{target:a}=s;this.props=t,this.events=n,this.document=De(a),this.documentListeners=new Le(this.document),this.listeners=new Le(r),this.windowListeners=new Le(z(a)),this.initialCoordinates=(o=tt(s))!=null?o:Q,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(_.Resize,this.handleCancel),this.windowListeners.add(_.DragStart,Kt),this.windowListeners.add(_.VisibilityChange,this.handleCancel),this.windowListeners.add(_.ContextMenu,Kt),this.documentListeners.add(_.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Vt(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Ht(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:o}=this.props;o(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(_.Click,qr,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(_.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:o,props:s}=this,{onMove:a,options:{activationConstraint:i}}=s;if(!o)return;const l=(n=tt(t))!=null?n:Q,d=Fe(o,l);if(!r&&i){if(Ht(i)){if(i.tolerance!=null&&vt(d,i.tolerance))return this.handleCancel();if(vt(d,i.distance))return this.handleStart()}if(Vt(i)&&vt(d,i.tolerance))return this.handleCancel();this.handlePending(i,d);return}t.cancelable&&t.preventDefault(),a(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===E.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Yr={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class jt extends Et{constructor(t){const{event:n}=t,r=De(n.target);super(t,Yr,r)}}jt.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r?.({event:n}),!0)}}];const Wr={move:{name:"mousemove"},end:{name:"mouseup"}};var xt;(function(e){e[e.RightClick=2]="RightClick"})(xt||(xt={}));class Kr extends Et{constructor(t){super(t,Wr,De(t.event.target))}}Kr.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===xt.RightClick?!1:(r?.({event:n}),!0)}}];const bt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Hr extends Et{constructor(t){super(t,bt)}static setup(){return window.addEventListener(bt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(bt.move.name,t)};function t(){}}}Hr.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return o.length>1?!1:(r?.({event:n}),!0)}}];var Pe;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Pe||(Pe={}));var rt;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(rt||(rt={}));function Vr(e){let{acceleration:t,activator:n=Pe.Pointer,canScroll:r,draggingRect:o,enabled:s,interval:a=5,order:i=rt.TreeOrder,pointerCoordinates:l,scrollableAncestors:d,scrollableAncestorRects:g,delta:f,threshold:h}=e;const p=_r({delta:f,disabled:!s}),[b,m]=ar(),v=c.useRef({x:0,y:0}),y=c.useRef({x:0,y:0}),w=c.useMemo(()=>{switch(n){case Pe.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Pe.DraggableRect:return o}},[n,o,l]),C=c.useRef(null),R=c.useCallback(()=>{const N=C.current;if(!N)return;const S=v.current.x*y.current.x,D=v.current.y*y.current.y;N.scrollBy(S,D)},[]),x=c.useMemo(()=>i===rt.TreeOrder?[...d].reverse():d,[i,d]);c.useEffect(()=>{if(!s||!d.length||!w){m();return}for(const N of x){if(r?.(N)===!1)continue;const S=d.indexOf(N),D=g[S];if(!D)continue;const{direction:k,speed:I}=Pr(N,D,w,t,h);for(const j of["x","y"])p[j][k[j]]||(I[j]=0,k[j]=0);if(I.x>0||I.y>0){m(),C.current=N,b(R,a),v.current=I,y.current=k;return}}v.current={x:0,y:0},y.current={x:0,y:0},m()},[t,R,r,m,s,a,JSON.stringify(w),JSON.stringify(p),b,d,x,g,JSON.stringify(h)])}const Gr={x:{[T.Backward]:!1,[T.Forward]:!1},y:{[T.Backward]:!1,[T.Forward]:!1}};function _r(e){let{delta:t,disabled:n}=e;const r=et(t);return qe(o=>{if(n||!r||!o)return Gr;const s={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[T.Backward]:o.x[T.Backward]||s.x===-1,[T.Forward]:o.x[T.Forward]||s.x===1},y:{[T.Backward]:o.y[T.Backward]||s.y===-1,[T.Forward]:o.y[T.Forward]||s.y===1}}},[n,t,r])}function Jr(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return qe(o=>{var s;return t==null?null:(s=r??o)!=null?s:null},[r,t])}function Qr(e,t){return c.useMemo(()=>e.reduce((n,r)=>{const{sensor:o}=r,s=o.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...s]},[]),[e,t])}var Ue;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Ue||(Ue={}));var yt;(function(e){e.Optimized="optimized"})(yt||(yt={}));const Gt=new Map;function Zr(e,t){let{dragging:n,dependencies:r,config:o}=t;const[s,a]=c.useState(null),{frequency:i,measure:l,strategy:d}=o,g=c.useRef(e),f=v(),h=ze(f),p=c.useCallback(function(y){y===void 0&&(y=[]),!h.current&&a(w=>w===null?y:w.concat(y.filter(C=>!w.includes(C))))},[h]),b=c.useRef(null),m=qe(y=>{if(f&&!n)return Gt;if(!y||y===Gt||g.current!==e||s!=null){const w=new Map;for(let C of e){if(!C)continue;if(s&&s.length>0&&!s.includes(C.id)&&C.rect.current){w.set(C.id,C.rect.current);continue}const R=C.node.current,x=R?new Nt(l(R),R):null;C.rect.current=x,x&&w.set(C.id,x)}return w}return y},[e,s,n,f,l]);return c.useEffect(()=>{g.current=e},[e]),c.useEffect(()=>{f||p()},[n,f]),c.useEffect(()=>{s&&s.length>0&&a(null)},[JSON.stringify(s)]),c.useEffect(()=>{f||typeof i!="number"||b.current!==null||(b.current=setTimeout(()=>{p(),b.current=null},i))},[i,f,p,...r]),{droppableRects:m,measureDroppableContainers:p,measuringScheduled:s!=null};function v(){switch(d){case Ue.Always:return!1;case Ue.BeforeDragging:return n;default:return!n}}}function At(e,t){return qe(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function eo(e,t){return At(e,t)}function to(e){let{callback:t,disabled:n}=e;const r=it(t),o=c.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,n]);return c.useEffect(()=>()=>o?.disconnect(),[o]),o}function ct(e){let{callback:t,disabled:n}=e;const r=it(t),o=c.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[n]);return c.useEffect(()=>()=>o?.disconnect(),[o]),o}function no(e){return new Nt(Ne(e),e)}function _t(e,t,n){t===void 0&&(t=no);const[r,o]=c.useState(null);function s(){o(l=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=l??n)!=null?d:null}const g=t(e);return JSON.stringify(l)===JSON.stringify(g)?l:g})}const a=to({callback(l){if(e)for(const d of l){const{type:g,target:f}=d;if(g==="childList"&&f instanceof HTMLElement&&f.contains(e)){s();break}}}}),i=ct({callback:s});return J(()=>{s(),e?(i?.observe(e),a?.observe(document.body,{childList:!0,subtree:!0})):(i?.disconnect(),a?.disconnect())},[e]),r}function ro(e){const t=At(e);return gn(e,t)}const Jt=[];function oo(e){const t=c.useRef(e),n=qe(r=>e?r&&r!==Jt&&e&&t.current&&e.parentNode===t.current.parentNode?r:lt(e):Jt,[e]);return c.useEffect(()=>{t.current=e},[e]),n}function so(e){const[t,n]=c.useState(null),r=c.useRef(e),o=c.useCallback(s=>{const a=pt(s.target);a&&n(i=>i?(i.set(a,mt(a)),new Map(i)):null)},[]);return c.useEffect(()=>{const s=r.current;if(e!==s){a(s);const i=e.map(l=>{const d=pt(l);return d?(d.addEventListener("scroll",o,{passive:!0}),[d,mt(d)]):null}).filter(l=>l!=null);n(i.length?new Map(i):null),r.current=e}return()=>{a(e),a(s)};function a(i){i.forEach(l=>{const d=pt(l);d?.removeEventListener("scroll",o)})}},[o,e]),c.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,a)=>Ce(s,a),Q):yn(e):Q,[e,t])}function Qt(e,t){t===void 0&&(t=[]);const n=c.useRef(null);return c.useEffect(()=>{n.current=null},t),c.useEffect(()=>{const r=e!==Q;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?Fe(e,n.current):Q}function io(e){c.useEffect(()=>{if(!st)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n?.()}},e.map(t=>{let{sensor:n}=t;return n}))}function ao(e,t){return c.useMemo(()=>e.reduce((n,r)=>{let{eventName:o,handler:s}=r;return n[o]=a=>{s(a,t)},n},{}),[e,t])}function Sn(e){return c.useMemo(()=>e?Ir(e):null,[e])}const Zt=[];function lo(e,t){t===void 0&&(t=Ne);const[n]=e,r=Sn(n?z(n):null),[o,s]=c.useState(Zt);function a(){s(()=>e.length?e.map(l=>mn(l)?r:new Nt(t(l),l)):Zt)}const i=ct({callback:a});return J(()=>{i?.disconnect(),a(),e.forEach(l=>i?.observe(l))},[e]),o}function Dn(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return $e(t)?t:e}function co(e){let{measure:t}=e;const[n,r]=c.useState(null),o=c.useCallback(d=>{for(const{target:g}of d)if($e(g)){r(f=>{const h=t(g);return f?{...f,width:h.width,height:h.height}:h});break}},[t]),s=ct({callback:o}),a=c.useCallback(d=>{const g=Dn(d);s?.disconnect(),g&&s?.observe(g),r(g?t(g):null)},[t,s]),[i,l]=Ze(a);return c.useMemo(()=>({nodeRef:i,rect:n,setRef:l}),[n,i,l])}const uo=[{sensor:jt,options:{}},{sensor:Rt,options:{}}],fo={current:{}},Qe={draggable:{measure:Wt},droppable:{measure:Wt,strategy:Ue.WhileDragging,frequency:yt.Optimized},dragOverlay:{measure:Ne}};class Be extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const go={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Be,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:nt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Qe,measureDroppableContainers:nt,windowRect:null,measuringScheduled:!1},Nn={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:nt,draggableNodes:new Map,over:null,measureDroppableContainers:nt},Ye=c.createContext(Nn),Rn=c.createContext(go);function ho(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Be}}}function po(e,t){switch(t.type){case M.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case M.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case M.DragEnd:case M.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case M.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new Be(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case M.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const a=new Be(e.droppable.containers);return a.set(n,{...s,disabled:o}),{...e,droppable:{...e.droppable,containers:a}}}case M.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const s=new Be(e.droppable.containers);return s.delete(n),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function vo(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:o}=c.useContext(Ye),s=et(r),a=et(n?.id);return c.useEffect(()=>{if(!t&&!r&&s&&a!=null){if(!at(s)||document.activeElement===s.target)return;const i=o.get(a);if(!i)return;const{activatorNode:l,node:d}=i;if(!l.current&&!d.current)return;requestAnimationFrame(()=>{for(const g of[l.current,d.current]){if(!g)continue;const f=dr(g);if(f){f.focus();break}}})}},[r,t,o,a,s]),null}function En(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((o,s)=>s({transform:o,...r}),n):n}function bo(e){return c.useMemo(()=>({draggable:{...Qe.draggable,...e?.draggable},droppable:{...Qe.droppable,...e?.droppable},dragOverlay:{...Qe.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function mo(e){let{activeNode:t,measure:n,initialRect:r,config:o=!0}=e;const s=c.useRef(!1),{x:a,y:i}=typeof o=="boolean"?{x:o,y:o}:o;J(()=>{if(!a&&!i||!t){s.current=!1;return}if(s.current||!r)return;const d=t?.node.current;if(!d||d.isConnected===!1)return;const g=n(d),f=gn(g,r);if(a||(f.x=0),i||(f.y=0),s.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const h=pn(d);h&&h.scrollBy({top:f.y,left:f.x})}},[t,a,i,r,n])}const dt=c.createContext({...Q,scaleX:1,scaleY:1});var ge;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(ge||(ge={}));const xo=c.memo(function(t){var n,r,o,s;let{id:a,accessibility:i,autoScroll:l=!0,children:d,sensors:g=uo,collisionDetection:f=Rr,measuring:h,modifiers:p,...b}=t;const m=c.useReducer(po,void 0,ho),[v,y]=m,[w,C]=vr(),[R,x]=c.useState(ge.Uninitialized),N=R===ge.Initialized,{draggable:{active:S,nodes:D,translate:k},droppable:{containers:I}}=v,j=S!=null?D.get(S):null,U=c.useRef({initial:null,translated:null}),$=c.useMemo(()=>{var P;return S!=null?{id:S,data:(P=j?.data)!=null?P:fo,rect:U}:null},[S,j]),q=c.useRef(null),[X,We]=c.useState(null),[Y,Ke]=c.useState(null),ne=ze(b,Object.values(b)),Re=Xe("DndDescribedBy",a),He=c.useMemo(()=>I.getEnabled(),[I]),F=bo(h),{droppableRects:re,measureDroppableContainers:pe,measuringScheduled:Ee}=Zr(He,{dragging:N,dependencies:[k.x,k.y],config:F.droppable}),V=Jr(D,S),Ve=c.useMemo(()=>Y?tt(Y):null,[Y]),ae=Un(),oe=eo(V,F.draggable.measure);mo({activeNode:S!=null?D.get(S):null,config:ae.layoutShiftCompensation,initialRect:oe,measure:F.draggable.measure});const A=_t(V,F.draggable.measure,oe),je=_t(V?V.parentElement:null),Z=c.useRef({activatorEvent:null,active:null,activeNode:V,collisionRect:null,collisions:null,droppableRects:re,draggableNodes:D,draggingNode:null,draggingNodeRect:null,droppableContainers:I,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ve=I.getNodeFor((n=Z.current.over)==null?void 0:n.id),se=co({measure:F.dragOverlay.measure}),be=(r=se.nodeRef.current)!=null?r:V,me=N?(o=se.rect)!=null?o:A:null,It=!!(se.nodeRef.current&&se.rect),Mt=ro(It?null:A),ut=Sn(be?z(be):null),le=oo(N?ve??V:null),Ge=lo(le),_e=En(p,{transform:{x:k.x-Mt.x,y:k.y-Mt.y,scaleX:1,scaleY:1},activatorEvent:Y,active:$,activeNodeRect:A,containerNodeRect:je,draggingNodeRect:me,over:Z.current.over,overlayNodeRect:se.rect,scrollableAncestors:le,scrollableAncestorRects:Ge,windowRect:ut}),Tt=Ve?Ce(Ve,k):null,Lt=so(le),Mn=Qt(Lt),Tn=Qt(Lt,[A]),xe=Ce(_e,Mn),ye=me?Ar(me,_e):null,Ae=$&&ye?f({active:$,collisionRect:ye,droppableRects:re,droppableContainers:He,pointerCoordinates:Tt}):null,Pt=fn(Ae,"id"),[ce,Bt]=c.useState(null),Ln=It?_e:Ce(_e,Tn),Pn=Er(Ln,(s=ce?.rect)!=null?s:null,A),ft=c.useRef(null),zt=c.useCallback((P,W)=>{let{sensor:K,options:de}=W;if(q.current==null)return;const G=D.get(q.current);if(!G)return;const H=P.nativeEvent,ee=new K({active:q.current,activeNode:G,event:H,options:de,context:Z,onAbort(L){if(!D.get(L))return;const{onDragAbort:te}=ne.current,ie={id:L};te?.(ie),w({type:"onDragAbort",event:ie})},onPending(L,ue,te,ie){if(!D.get(L))return;const{onDragPending:Oe}=ne.current,fe={id:L,constraint:ue,initialCoordinates:te,offset:ie};Oe?.(fe),w({type:"onDragPending",event:fe})},onStart(L){const ue=q.current;if(ue==null)return;const te=D.get(ue);if(!te)return;const{onDragStart:ie}=ne.current,ke={activatorEvent:H,active:{id:ue,data:te.data,rect:U}};Me.unstable_batchedUpdates(()=>{ie?.(ke),x(ge.Initializing),y({type:M.DragStart,initialCoordinates:L,active:ue}),w({type:"onDragStart",event:ke}),We(ft.current),Ke(H)})},onMove(L){y({type:M.DragMove,coordinates:L})},onEnd:we(M.DragEnd),onCancel:we(M.DragCancel)});ft.current=ee;function we(L){return async function(){const{active:te,collisions:ie,over:ke,scrollAdjustedTranslate:Oe}=Z.current;let fe=null;if(te&&Oe){const{cancelDrop:Ie}=ne.current;fe={activatorEvent:H,active:te,collisions:ie,delta:Oe,over:ke},L===M.DragEnd&&typeof Ie=="function"&&await Promise.resolve(Ie(fe))&&(L=M.DragCancel)}q.current=null,Me.unstable_batchedUpdates(()=>{y({type:L}),x(ge.Uninitialized),Bt(null),We(null),Ke(null),ft.current=null;const Ie=L===M.DragEnd?"onDragEnd":"onDragCancel";if(fe){const gt=ne.current[Ie];gt?.(fe),w({type:Ie,event:fe})}})}}},[D]),Bn=c.useCallback((P,W)=>(K,de)=>{const G=K.nativeEvent,H=D.get(de);if(q.current!==null||!H||G.dndKit||G.defaultPrevented)return;const ee={active:H};P(K,W.options,ee)===!0&&(G.dndKit={capturedBy:W.sensor},q.current=de,zt(K,W))},[D,zt]),Ft=Qr(g,Bn);io(g),J(()=>{A&&R===ge.Initializing&&x(ge.Initialized)},[A,R]),c.useEffect(()=>{const{onDragMove:P}=ne.current,{active:W,activatorEvent:K,collisions:de,over:G}=Z.current;if(!W||!K)return;const H={active:W,activatorEvent:K,collisions:de,delta:{x:xe.x,y:xe.y},over:G};Me.unstable_batchedUpdates(()=>{P?.(H),w({type:"onDragMove",event:H})})},[xe.x,xe.y]),c.useEffect(()=>{const{active:P,activatorEvent:W,collisions:K,droppableContainers:de,scrollAdjustedTranslate:G}=Z.current;if(!P||q.current==null||!W||!G)return;const{onDragOver:H}=ne.current,ee=de.get(Pt),we=ee&&ee.rect.current?{id:ee.id,rect:ee.rect.current,data:ee.data,disabled:ee.disabled}:null,L={active:P,activatorEvent:W,collisions:K,delta:{x:G.x,y:G.y},over:we};Me.unstable_batchedUpdates(()=>{Bt(we),H?.(L),w({type:"onDragOver",event:L})})},[Pt]),J(()=>{Z.current={activatorEvent:Y,active:$,activeNode:V,collisionRect:ye,collisions:Ae,droppableRects:re,draggableNodes:D,draggingNode:be,draggingNodeRect:me,droppableContainers:I,over:ce,scrollableAncestors:le,scrollAdjustedTranslate:xe},U.current={initial:me,translated:ye}},[$,V,Ae,ye,D,be,me,re,I,ce,le,xe]),Vr({...ae,delta:k,draggingRect:ye,pointerCoordinates:Tt,scrollableAncestors:le,scrollableAncestorRects:Ge});const zn=c.useMemo(()=>({active:$,activeNode:V,activeNodeRect:A,activatorEvent:Y,collisions:Ae,containerNodeRect:je,dragOverlay:se,draggableNodes:D,droppableContainers:I,droppableRects:re,over:ce,measureDroppableContainers:pe,scrollableAncestors:le,scrollableAncestorRects:Ge,measuringConfiguration:F,measuringScheduled:Ee,windowRect:ut}),[$,V,A,Y,Ae,je,se,D,I,re,ce,pe,le,Ge,F,Ee,ut]),Fn=c.useMemo(()=>({activatorEvent:Y,activators:Ft,active:$,activeNodeRect:A,ariaDescribedById:{draggable:Re},dispatch:y,draggableNodes:D,over:ce,measureDroppableContainers:pe}),[Y,Ft,$,A,y,Re,D,ce,pe]);return O.createElement(cn.Provider,{value:C},O.createElement(Ye.Provider,{value:Fn},O.createElement(Rn.Provider,{value:zn},O.createElement(dt.Provider,{value:Pn},d)),O.createElement(vo,{disabled:i?.restoreFocus===!1})),O.createElement(xr,{...i,hiddenTextDescribedById:Re}));function Un(){const P=X?.autoScrollEnabled===!1,W=typeof l=="object"?l.enabled===!1:l===!1,K=N&&!P&&!W;return typeof l=="object"?{...l,enabled:K}:{enabled:K}}}),yo=c.createContext(null),en="button",wo="Draggable";function Co(e){let{id:t,data:n,disabled:r=!1,attributes:o}=e;const s=Xe(wo),{activators:a,activatorEvent:i,active:l,activeNodeRect:d,ariaDescribedById:g,draggableNodes:f,over:h}=c.useContext(Ye),{role:p=en,roleDescription:b="draggable",tabIndex:m=0}=o??{},v=l?.id===t,y=c.useContext(v?dt:yo),[w,C]=Ze(),[R,x]=Ze(),N=ao(a,t),S=ze(n);J(()=>(f.set(t,{id:t,key:s,node:w,activatorNode:R,data:S}),()=>{const k=f.get(t);k&&k.key===s&&f.delete(t)}),[f,t]);const D=c.useMemo(()=>({role:p,tabIndex:m,"aria-disabled":r,"aria-pressed":v&&p===en?!0:void 0,"aria-roledescription":b,"aria-describedby":g.draggable}),[r,p,m,v,b,g.draggable]);return{active:l,activatorEvent:i,activeNodeRect:d,attributes:D,isDragging:v,listeners:r?void 0:N,node:w,over:h,setNodeRef:C,setActivatorNodeRef:x,transform:y}}function jn(){return c.useContext(Rn)}const So="Droppable",Do={timeout:25};function No(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:o}=e;const s=Xe(So),{active:a,dispatch:i,over:l,measureDroppableContainers:d}=c.useContext(Ye),g=c.useRef({disabled:n}),f=c.useRef(!1),h=c.useRef(null),p=c.useRef(null),{disabled:b,updateMeasurementsFor:m,timeout:v}={...Do,...o},y=ze(m??r),w=c.useCallback(()=>{if(!f.current){f.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{d(Array.isArray(y.current)?y.current:[y.current]),p.current=null},v)},[v]),C=ct({callback:w,disabled:b||!a}),R=c.useCallback((D,k)=>{C&&(k&&(C.unobserve(k),f.current=!1),D&&C.observe(D))},[C]),[x,N]=Ze(R),S=ze(t);return c.useEffect(()=>{!C||!x.current||(C.disconnect(),f.current=!1,C.observe(x.current))},[x,C]),c.useEffect(()=>(i({type:M.RegisterDroppable,element:{id:r,key:s,disabled:n,node:x,rect:h,data:S}}),()=>i({type:M.UnregisterDroppable,key:s,id:r})),[r]),c.useEffect(()=>{n!==g.current.disabled&&(i({type:M.SetDroppableDisabled,id:r,key:s,disabled:n}),g.current.disabled=n)},[r,s,n,i]),{active:a,rect:h,isOver:l?.id===r,node:x,over:l,setNodeRef:N}}function Ro(e){let{animation:t,children:n}=e;const[r,o]=c.useState(null),[s,a]=c.useState(null),i=et(n);return!n&&!r&&i&&o(i),J(()=>{if(!s)return;const l=r?.key,d=r?.props.id;if(l==null||d==null){o(null);return}Promise.resolve(t(d,s)).then(()=>{o(null)})},[t,r,s]),O.createElement(O.Fragment,null,n,r?c.cloneElement(r,{ref:a}):null)}const Eo={x:0,y:0,scaleX:1,scaleY:1};function jo(e){let{children:t}=e;return O.createElement(Ye.Provider,{value:Nn},O.createElement(dt.Provider,{value:Eo},t))}const Ao={position:"fixed",touchAction:"none"},ko=e=>at(e)?"transform 250ms ease":void 0,Oo=c.forwardRef((e,t)=>{let{as:n,activatorEvent:r,adjustScale:o,children:s,className:a,rect:i,style:l,transform:d,transition:g=ko}=e;if(!i)return null;const f=o?d:{...d,scaleX:1,scaleY:1},h={...Ao,width:i.width,height:i.height,top:i.top,left:i.left,transform:he.Transform.toString(f),transformOrigin:o&&r?wr(r,i):void 0,transition:typeof g=="function"?g(r):g,...l};return O.createElement(n,{className:a,style:h,ref:t},s)}),Io=e=>t=>{let{active:n,dragOverlay:r}=t;const o={},{styles:s,className:a}=e;if(s!=null&&s.active)for(const[i,l]of Object.entries(s.active))l!==void 0&&(o[i]=n.node.style.getPropertyValue(i),n.node.style.setProperty(i,l));if(s!=null&&s.dragOverlay)for(const[i,l]of Object.entries(s.dragOverlay))l!==void 0&&r.node.style.setProperty(i,l);return a!=null&&a.active&&n.node.classList.add(a.active),a!=null&&a.dragOverlay&&r.node.classList.add(a.dragOverlay),function(){for(const[l,d]of Object.entries(o))n.node.style.setProperty(l,d);a!=null&&a.active&&n.node.classList.remove(a.active)}},Mo=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:he.Transform.toString(t)},{transform:he.Transform.toString(n)}]},To={duration:250,easing:"ease",keyframes:Mo,sideEffects:Io({styles:{active:{opacity:"0"}}})};function Lo(e){let{config:t,draggableNodes:n,droppableContainers:r,measuringConfiguration:o}=e;return it((s,a)=>{if(t===null)return;const i=n.get(s);if(!i)return;const l=i.node.current;if(!l)return;const d=Dn(a);if(!d)return;const{transform:g}=z(a).getComputedStyle(a),f=hn(g);if(!f)return;const h=typeof t=="function"?t:Po(t);return wn(l,o.draggable.measure),h({active:{id:s,data:i.data,node:l,rect:o.draggable.measure(l)},draggableNodes:n,dragOverlay:{node:a,rect:o.dragOverlay.measure(d)},droppableContainers:r,measuringConfiguration:o,transform:f})})}function Po(e){const{duration:t,easing:n,sideEffects:r,keyframes:o}={...To,...e};return s=>{let{active:a,dragOverlay:i,transform:l,...d}=s;if(!t)return;const g={x:i.rect.left-a.rect.left,y:i.rect.top-a.rect.top},f={scaleX:l.scaleX!==1?a.rect.width*l.scaleX/i.rect.width:1,scaleY:l.scaleY!==1?a.rect.height*l.scaleY/i.rect.height:1},h={x:l.x-g.x,y:l.y-g.y,...f},p=o({...d,active:a,dragOverlay:i,transform:{initial:l,final:h}}),[b]=p,m=p[p.length-1];if(JSON.stringify(b)===JSON.stringify(m))return;const v=r?.({active:a,dragOverlay:i,...d}),y=i.node.animate(p,{duration:t,easing:n,fill:"forwards"});return new Promise(w=>{y.onfinish=()=>{v?.(),w()}})}}let tn=0;function Bo(e){return c.useMemo(()=>{if(e!=null)return tn++,tn},[e])}const zo=O.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:r,style:o,transition:s,modifiers:a,wrapperElement:i="div",className:l,zIndex:d=999}=e;const{activatorEvent:g,active:f,activeNodeRect:h,containerNodeRect:p,draggableNodes:b,droppableContainers:m,dragOverlay:v,over:y,measuringConfiguration:w,scrollableAncestors:C,scrollableAncestorRects:R,windowRect:x}=jn(),N=c.useContext(dt),S=Bo(f?.id),D=En(a,{activatorEvent:g,active:f,activeNodeRect:h,containerNodeRect:p,draggingNodeRect:v.rect,over:y,overlayNodeRect:v.rect,scrollableAncestors:C,scrollableAncestorRects:R,transform:N,windowRect:x}),k=At(h),I=Lo({config:r,draggableNodes:b,droppableContainers:m,measuringConfiguration:w}),j=k?v.setRef:void 0;return O.createElement(jo,null,O.createElement(Ro,{animation:I},f&&S?O.createElement(Oo,{key:S,id:f.id,ref:j,as:i,activatorEvent:g,adjustScale:t,className:l,transition:s,rect:k,style:{zIndex:d,...o},transform:D},n):null))});function kt(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function Fo(e,t){return e.reduce((n,r,o)=>{const s=t.get(r);return s&&(n[o]=s),n},Array(e.length))}function Je(e){return e!==null&&e>=0}function Uo(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function $o(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Ot=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const s=kt(t,r,n),a=t[o],i=s[o];return!i||!a?null:{x:i.left-a.left,y:i.top-a.top,scaleX:i.width/a.width,scaleY:i.height/a.height}},An="Sortable",kn=O.createContext({activeIndex:-1,containerId:An,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Ot,disabled:{draggable:!1,droppable:!1}});function qo(e){let{children:t,id:n,items:r,strategy:o=Ot,disabled:s=!1}=e;const{active:a,dragOverlay:i,droppableRects:l,over:d,measureDroppableContainers:g}=jn(),f=Xe(An,n),h=i.rect!==null,p=c.useMemo(()=>r.map(N=>typeof N=="object"&&"id"in N?N.id:N),[r]),b=a!=null,m=a?p.indexOf(a.id):-1,v=d?p.indexOf(d.id):-1,y=c.useRef(p),w=!Uo(p,y.current),C=v!==-1&&m===-1||w,R=$o(s);J(()=>{w&&b&&g(p)},[w,p,b,g]),c.useEffect(()=>{y.current=p},[p]);const x=c.useMemo(()=>({activeIndex:m,containerId:f,disabled:R,disableTransforms:C,items:p,overIndex:v,useDragOverlay:h,sortedRects:Fo(p,l),strategy:o}),[m,f,R.draggable,R.droppable,C,p,v,l,h,o]);return O.createElement(kn.Provider,{value:x},t)}const Xo=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return kt(n,r,o).indexOf(t)},Yo=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:s,newIndex:a,previousItems:i,previousContainerId:l,transition:d}=e;return!d||!r||i!==s&&o===a?!1:n?!0:a!==o&&t===l},Wo={duration:200,easing:"ease"},On="transform",Ko=he.Transition.toString({property:On,duration:0,easing:"linear"}),Ho={roleDescription:"sortable"};function Vo(e){let{disabled:t,index:n,node:r,rect:o}=e;const[s,a]=c.useState(null),i=c.useRef(n);return J(()=>{if(!t&&n!==i.current&&r.current){const l=o.current;if(l){const d=Ne(r.current,{ignoreTransform:!0}),g={x:l.left-d.left,y:l.top-d.top,scaleX:l.width/d.width,scaleY:l.height/d.height};(g.x||g.y)&&a(g)}}n!==i.current&&(i.current=n)},[t,n,r,o]),c.useEffect(()=>{s&&a(null)},[s]),s}function Go(e){let{animateLayoutChanges:t=Yo,attributes:n,disabled:r,data:o,getNewIndex:s=Xo,id:a,strategy:i,resizeObserverConfig:l,transition:d=Wo}=e;const{items:g,containerId:f,activeIndex:h,disabled:p,disableTransforms:b,sortedRects:m,overIndex:v,useDragOverlay:y,strategy:w}=c.useContext(kn),C=_o(r,p),R=g.indexOf(a),x=c.useMemo(()=>({sortable:{containerId:f,index:R,items:g},...o}),[f,o,R,g]),N=c.useMemo(()=>g.slice(g.indexOf(a)),[g,a]),{rect:S,node:D,isOver:k,setNodeRef:I}=No({id:a,data:x,disabled:C.droppable,resizeObserverConfig:{updateMeasurementsFor:N,...l}}),{active:j,activatorEvent:U,activeNodeRect:$,attributes:q,setNodeRef:X,listeners:We,isDragging:Y,over:Ke,setActivatorNodeRef:ne,transform:Re}=Co({id:a,data:x,attributes:{...Ho,...n},disabled:C.draggable}),He=ir(I,X),F=!!j,re=F&&!b&&Je(h)&&Je(v),pe=!y&&Y,Ee=pe&&re?Re:null,Ve=re?Ee??(i??w)({rects:m,activeNodeRect:$,activeIndex:h,overIndex:v,index:R}):null,ae=Je(h)&&Je(v)?s({id:a,items:g,activeIndex:h,overIndex:v}):R,oe=j?.id,A=c.useRef({activeId:oe,items:g,newIndex:ae,containerId:f}),je=g!==A.current.items,Z=t({active:j,containerId:f,isDragging:Y,isSorting:F,id:a,index:R,items:g,newIndex:A.current.newIndex,previousItems:A.current.items,previousContainerId:A.current.containerId,transition:d,wasDragging:A.current.activeId!=null}),ve=Vo({disabled:!Z,index:R,node:D,rect:S});return c.useEffect(()=>{F&&A.current.newIndex!==ae&&(A.current.newIndex=ae),f!==A.current.containerId&&(A.current.containerId=f),g!==A.current.items&&(A.current.items=g)},[F,ae,f,g]),c.useEffect(()=>{if(oe===A.current.activeId)return;if(oe!=null&&A.current.activeId==null){A.current.activeId=oe;return}const be=setTimeout(()=>{A.current.activeId=oe},50);return()=>clearTimeout(be)},[oe]),{active:j,activeIndex:h,attributes:q,data:x,rect:S,index:R,newIndex:ae,items:g,isOver:k,isSorting:F,isDragging:Y,listeners:We,node:D,overIndex:v,over:Ke,setNodeRef:He,setActivatorNodeRef:ne,setDroppableNodeRef:I,setDraggableNodeRef:X,transform:ve??Ve,transition:se()};function se(){if(ve||je&&A.current.newIndex===R)return Ko;if(!(pe&&!at(U)||!d)&&(F||Z))return he.Transition.toString({...d,property:On})}}function _o(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e?.draggable)!=null?n:t.draggable,droppable:(r=e?.droppable)!=null?r:t.droppable}}function ot(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Jo=[E.Down,E.Right,E.Up,E.Left],Qo=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:o,droppableContainers:s,over:a,scrollableAncestors:i}}=t;if(Jo.includes(e.code)){if(e.preventDefault(),!n||!r)return;const l=[];s.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const h=o.get(f.id);if(h)switch(e.code){case E.Down:r.top<h.top&&l.push(f);break;case E.Up:r.top>h.top&&l.push(f);break;case E.Left:r.left>h.left&&l.push(f);break;case E.Right:r.left<h.left&&l.push(f);break}});const d=Dr({collisionRect:r,droppableRects:o,droppableContainers:l});let g=fn(d,"id");if(g===a?.id&&d.length>1&&(g=d[1].id),g!=null){const f=s.get(n.id),h=s.get(g),p=h?o.get(h.id):null,b=h?.node.current;if(b&&p&&f&&h){const v=lt(b).some((N,S)=>i[S]!==N),y=In(f,h),w=Zo(f,h),C=v||!y?{x:0,y:0}:{x:w?r.width-p.width:0,y:w?r.height-p.height:0},R={x:p.left,y:p.top};return C.x&&C.y?R:Fe(R,C)}}}};function In(e,t){return!ot(e)||!ot(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Zo(e,t){return!ot(e)||!ot(t)||!In(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}function wt({item:e,type:t,isOverlay:n=!1,isEditing:r=!1,dragListeners:o={},dragAttributes:s={}}){const a=t==="anime"?`/anime/${e.id}`:`/character/${e.id}`;return u.jsxs("div",{className:B("relative aspect-[2/3] rounded-xl overflow-hidden bg-bg-tertiary border border-border-color shadow-sm group transition-all",n&&"cursor-grabbing scale-105 shadow-2xl ring-2 ring-primary z-50",r&&"hover:border-primary/50"),children:[r&&u.jsx("div",{...o,...s,className:"absolute top-2 right-2 z-20 p-2 bg-black/60 backdrop-blur-md rounded-lg cursor-grab active:cursor-grabbing hover:bg-primary transition-colors touch-none shadow-lg",children:u.jsx(nr,{className:"w-4 h-4 text-white"})}),u.jsxs(rr,{to:r?"#":a,className:B("block w-full h-full",r&&"pointer-events-none"),draggable:!1,children:[u.jsx("img",{src:e.image,alt:e.title||e.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",draggable:!1}),u.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-80"}),u.jsx("div",{className:"absolute bottom-0 left-0 p-3 w-full",children:u.jsx("h4",{className:"text-white text-xs md:text-sm font-bold line-clamp-2 leading-tight drop-shadow-md",children:e.title||e.name})})]})]})}function es({item:e,type:t,isEditing:n}){const{attributes:r,listeners:o,setNodeRef:s,transform:a,transition:i,isDragging:l}=Go({id:e.id,disabled:!n}),d={transform:he.Transform.toString(a),transition:i,opacity:l?.3:1,touchAction:"none"};return u.jsx("div",{ref:s,style:d,children:u.jsx(wt,{item:e,type:t,isEditing:n,dragListeners:o,dragAttributes:r})})}function ls({animeFavorites:e,characterFavorites:t,onReorderAnimes:n,onReorderCharacters:r,preferredView:o,onSetPreferredView:s,readOnly:a=!1}){const[i,l]=c.useState(o||"anime"),[d,g]=c.useState(!1);c.useEffect(()=>{o&&l(o)},[o]);const f=o===i,h=i==="anime"?e:t,p=i,[b,m]=c.useState(h.slice(0,6));c.useEffect(()=>{m(h.slice(0,6))},[h,i]);const[v,y]=c.useState(null),w=yr(qt(jt,{activationConstraint:{distance:5}}),qt(Rt,{coordinateGetter:Qo})),C=x=>{const{active:N,over:S}=x;N.id!==S?.id&&m(D=>{const k=D.findIndex(X=>X.id===N.id),I=D.findIndex(X=>X.id===S.id),j=kt(D,k,I),U=j.map(X=>X.id),$=h.slice(6).map(X=>X.id),q=[...U,...$];return i==="anime"?n(q):r(q),j}),y(null)},R=()=>{s(f?null:i)};return u.jsxs("div",{className:"bg-bg-secondary border border-border-color rounded-2xl p-6 relative overflow-hidden",children:[u.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-primary/5 rounded-full blur-[80px] -translate-y-1/2 translate-x-1/2 pointer-events-none"}),u.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-8 relative z-10",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:"flex p-1 bg-bg-tertiary rounded-xl border border-border-color",children:["anime","character"].map(x=>u.jsxs("button",{onClick:()=>{l(x),g(!1)},className:B("px-5 py-2 rounded-lg text-sm font-bold transition-all flex items-center gap-2",i===x?"bg-bg-secondary text-primary shadow-sm ring-1 ring-border-color":"text-text-secondary hover:text-text-primary hover:bg-white/5"),children:[x==="anime"?u.jsx(Ut,{className:B("w-4 h-4",i==="anime"&&"fill-current")}):u.jsx(Jn,{className:B("w-4 h-4",i==="character"&&"fill-current")}),x==="anime"?"Animes":"Personagens"]},x))}),u.jsxs("span",{className:"text-xs font-bold text-text-secondary bg-bg-tertiary px-3 py-1.5 rounded-full border border-border-color",children:[b.length," / 6"]})]}),!a&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("button",{onClick:()=>g(!d),className:B("flex items-center gap-2 text-xs font-bold px-4 py-2 rounded-lg border transition-all",d?"bg-green-500/10 text-green-500 border-green-500/20 hover:bg-green-500/20":"bg-bg-tertiary text-text-secondary border-border-color hover:text-text-primary hover:bg-bg-tertiary/80"),children:[d?u.jsx(Qn,{className:"w-3.5 h-3.5"}):u.jsx(Zn,{className:"w-3.5 h-3.5"}),d?"Concluir":"Organizar"]}),u.jsx("button",{onClick:R,className:B("p-2 rounded-lg border transition-all",f?"bg-primary/10 text-primary border-primary/20 hover:bg-primary/20":"bg-transparent text-text-secondary border-transparent hover:bg-bg-tertiary"),title:f?"VisÃ£o padrÃ£o definida":"Definir como visÃ£o padrÃ£o",children:u.jsx(er,{className:B("w-4 h-4",f&&"fill-current")})})]})]}),a?u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3 md:gap-4 relative z-10",children:[b.map(x=>u.jsx(wt,{item:x,type:p},x.id)),b.length===0&&u.jsxs("div",{className:"col-span-full py-12 text-center border-2 border-dashed border-border-color rounded-xl",children:[u.jsx(Ut,{className:"w-12 h-12 text-text-secondary/20 mx-auto mb-3"}),u.jsx("p",{className:"text-text-secondary font-medium",children:"Nenhum favorito selecionado."})]})]}):u.jsxs(xo,{sensors:w,collisionDetection:Sr,onDragStart:x=>y(x.active.id),onDragEnd:C,children:[u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3 md:gap-4 relative z-10",children:[u.jsx(qo,{items:b.map(x=>x.id),strategy:Ot,children:b.map(x=>u.jsx(es,{item:x,type:p,isEditing:d},x.id))}),Array.from({length:6-b.length}).map((x,N)=>u.jsxs("div",{className:"aspect-[2/3] rounded-xl border-2 border-dashed border-border-color bg-bg-tertiary/30 flex flex-col items-center justify-center gap-3 text-text-secondary/50 hover:text-primary hover:border-primary/30 hover:bg-primary/5 transition-all cursor-pointer group",children:[u.jsx("div",{className:"p-3 rounded-full bg-bg-tertiary group-hover:scale-110 transition-transform shadow-sm",children:u.jsx(tr,{className:"w-5 h-5"})}),u.jsx("span",{className:"text-xs font-bold uppercase tracking-wider opacity-70",children:"Vazio"})]},`empty-${N}`))]}),u.jsx(zo,{adjustScale:!0,children:v?u.jsx(wt,{item:b.find(x=>x.id===v),type:p,isOverlay:!0,isEditing:!0}):null})]})]})}function cs({className:e,...t}){return u.jsx("div",{className:B("relative overflow-hidden bg-bg-secondary rounded-xl",e),...t,children:u.jsx("div",{className:"absolute inset-0 -translate-x-full animate-shimmer bg-gradient-to-r from-transparent via-white/5 to-transparent z-10"})})}export{as as A,ls as F,is as P,cs as S};
