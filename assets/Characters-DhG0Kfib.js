import{j as e}from"./index-CPSkf6_A.js";import{L as w}from"./Layout-B3H3bNmt.js";import{r as o,L as k,h as _}from"./vendor-CzuZ2vSz.js";import{u as C}from"./usePageTitle-XJJnLCUf.js";import{H as j,U as f,x as L,o as S}from"./ui-DGQG60Ii.js";import"./firebase-sbJdvLJZ.js";function M(){const[r,t]=o.useState([]),[n,m]=o.useState(!0),[i,l]=o.useState(1),[d,s]=o.useState(!0);o.useEffect(()=>{let x=!0;const u=new AbortController;async function v(){try{m(!0),await new Promise(g=>setTimeout(g,600));const c=await fetch(`https://api.jikan.moe/v4/top/characters?page=${i}&limit=25`,{signal:u.signal});if(!c.ok)throw new Error(`Status: ${c.status}`);const h=await c.json();if(!x)return;const p=h.data||[],y=h.pagination||{};t(g=>{if(i===1)return p;const N=[...g,...p];return Array.from(new Map(N.map(b=>[b.mal_id,b])).values())}),s(y.has_next_page||p.length>0&&p.length>=25)}catch(c){c.name!=="AbortError"&&console.error("Erro fetch characters:",c)}finally{x&&m(!1)}}return v(),()=>{x=!1,u.abort()}},[i]);const a=o.useCallback(()=>{!n&&d&&l(x=>x+1)},[n,d]);return{characters:r,loading:n,loadMore:a,hasMore:d}}function E({character:r,rank:t}){return e.jsxs(k,{to:`/character/${r.mal_id}`,className:"block group relative bg-bg-secondary rounded-2xl overflow-hidden shadow-sm border border-border-color hover:border-primary/50 transition-all duration-300 hover:-translate-y-1 hover:shadow-xl",children:[e.jsxs("div",{className:"aspect-[3/4] overflow-hidden relative",children:[e.jsx("img",{src:r.images?.jpg?.image_url,alt:r.name,loading:"lazy",className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsx("div",{className:"absolute top-2 left-2 bg-black/60 backdrop-blur-md px-3 py-1.5 rounded-lg flex items-center justify-center border border-white/10 shadow-lg",children:e.jsxs("span",{className:"text-white font-bold text-sm",children:["#",t]})})]}),e.jsxs("div",{className:"p-4 bg-bg-secondary group-hover:bg-bg-tertiary transition-colors",children:[e.jsx("h3",{className:"text-base font-bold text-text-primary truncate mb-3",title:r.name,children:r.name}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] font-bold bg-primary/10 text-primary px-2 py-1 rounded-md truncate max-w-[60%] border border-primary/20",children:r.name_kanji||"N/A"}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-bold text-red-500 bg-red-500/10 px-2 py-1 rounded-md",children:[e.jsx(j,{className:"w-3.5 h-3.5 fill-current"}),e.jsx("span",{children:(r.favorites||0).toLocaleString()})]})]})]})]})}function $({character:r,rank:t}){const n=_();return e.jsxs("div",{onClick:()=>n(`/character/${r.mal_id}`),className:"group flex items-center gap-6 p-4 bg-bg-secondary hover:bg-bg-tertiary rounded-xl border border-transparent hover:border-border-color transition-all duration-300 cursor-pointer",children:[e.jsx("div",{className:"flex-shrink-0 w-12 text-center",children:e.jsxs("span",{className:"text-2xl font-black text-text-secondary/20 group-hover:text-primary/50 transition-colors",children:["#",t]})}),e.jsx("div",{className:"w-16 h-24 flex-shrink-0 rounded-lg overflow-hidden shadow-sm relative",children:e.jsx("img",{src:r.images?.jpg?.image_url,alt:r.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"})}),e.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[e.jsx("h3",{className:"text-lg font-bold text-text-primary group-hover:text-primary transition-colors truncate",children:r.name}),e.jsx("p",{className:"text-sm text-text-secondary truncate",children:r.name_kanji}),e.jsx("div",{className:"flex items-center gap-6 mt-2",children:e.jsxs("div",{className:"flex items-center gap-1.5 text-sm font-medium text-text-secondary",children:[e.jsx(j,{className:"w-4 h-4 text-primary fill-primary/20"}),r.favorites?.toLocaleString(),e.jsx("span",{className:"text-text-secondary/50 text-xs font-normal ml-1",children:"favoritos"})]})}),e.jsx("p",{className:"text-sm text-text-secondary/80 mt-3 line-clamp-2 md:line-clamp-3 leading-relaxed",children:r.about?r.about.replace(/\\n/g," "):"Sem informações disponíveis sobre este personagem."})]}),e.jsx("div",{className:"hidden md:block",children:e.jsx("button",{className:"px-4 py-2 rounded-lg bg-bg-primary text-text-primary text-sm font-medium border border-border-color group-hover:border-primary group-hover:text-primary transition-all",children:"Ver Detalhes"})})]})}function R(){const{characters:r,loading:t,loadMore:n,hasMore:m}=M(),i=o.useRef(null),[l,d]=o.useState(()=>localStorage.getItem("anime_chars_view_mode")||"grid");return o.useEffect(()=>{localStorage.setItem("anime_chars_view_mode",l)},[l]),C("Personagens"),o.useEffect(()=>{const s=new IntersectionObserver(a=>{a[0].isIntersecting&&m&&!t&&n()},{rootMargin:"200px"});return i.current&&s.observe(i.current),()=>s.disconnect()},[m,t,n]),e.jsx(w,{children:e.jsx("div",{className:"min-h-screen bg-bg-primary text-text-primary font-sans pb-20",children:e.jsxs("div",{className:"p-4 sm:p-6 lg:p-10 max-w-[1600px] mx-auto",children:[e.jsxs("div",{className:"mb-8 md:mb-12 flex flex-col md:flex-row md:items-end justify-between gap-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl md:text-5xl font-black text-text-primary mb-3 flex items-center gap-3 tracking-tight",children:[e.jsx("span",{className:"p-2 md:p-3 bg-primary/10 rounded-2xl text-primary",children:e.jsx(f,{className:"w-8 h-8 md:w-10 md:h-10"})}),"Top Personagens"]}),e.jsx("p",{className:"text-base md:text-lg text-text-secondary max-w-2xl leading-relaxed",children:"Os ícones que marcaram gerações. Vote nos seus favoritos e descubra novas lendas."})]}),e.jsxs("div",{className:"flex items-center gap-1 bg-bg-secondary p-1.5 rounded-xl border border-border-color self-start md:self-auto shadow-sm",children:[e.jsx("button",{onClick:()=>d("grid"),className:`p-2.5 rounded-lg transition-all ${l==="grid"?"bg-bg-tertiary text-primary shadow-sm ring-1 ring-border-color":"text-text-secondary hover:text-text-primary hover:bg-bg-tertiary/50"}`,title:"Visualização em Grade",children:e.jsx(L,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>d("list"),className:`p-2.5 rounded-lg transition-all ${l==="list"?"bg-bg-tertiary text-primary shadow-sm ring-1 ring-border-color":"text-text-secondary hover:text-text-primary hover:bg-bg-tertiary/50"}`,title:"Visualização em Lista",children:e.jsx(S,{className:"w-5 h-5"})})]})]}),l==="grid"?e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-6 lg:gap-8",children:[r.map((s,a)=>e.jsx(E,{character:s,rank:a+1},s.mal_id)),t&&Array.from({length:10}).map((s,a)=>e.jsx("div",{className:"bg-bg-secondary rounded-3xl overflow-hidden shadow-sm border border-border-color aspect-[3/4] animate-pulse relative",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"})},`skeleton-${a}`))]}):e.jsxs("div",{className:"flex flex-col gap-4",children:[r.map((s,a)=>e.jsx($,{character:s,rank:a+1},s.mal_id)),t&&Array.from({length:5}).map((s,a)=>e.jsx("div",{className:"h-24 bg-bg-secondary rounded-2xl animate-pulse border border-border-color"},`skeleton-list-${a}`))]}),e.jsx("div",{ref:i,className:"h-20 mt-8 flex items-center justify-center",children:t&&r.length>0&&e.jsx("div",{className:"w-8 h-8 border-4 border-primary/30 border-t-primary rounded-full animate-spin"})}),!t&&r.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-text-secondary gap-4",children:[e.jsx(f,{className:"w-16 h-16 opacity-20"}),e.jsx("p",{className:"text-lg font-medium",children:"Nenhum personagem encontrado."})]})]})})})}export{R as Characters};
