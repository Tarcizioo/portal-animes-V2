import{j as e}from"./index-CMIBCG0R.js";import{L as B,r as c,h as P}from"./vendor-C_qnnqqA.js";import{u as O,S as R,H as z}from"./usePageTitle-C2_vp2o_.js";import{A as G,S as D}from"./SkeletonCard-B9ZC3lfy.js";import{S as H,u as L,i as q,F as I,U,l as V,X as _,v as E,w as Z,x as M,y as X,j as Y,z as J,p as K,n as Q}from"./ui-D941AMjE.js";import"./firebase-Db2SPaPN.js";function W({id:b,title:d,image:g,score:p,synopsis:a,status:n,members:u,year:x,episodes:s,type:h,genres:w}){const f=a?.length>250?a.substring(0,250)+"...":a,j=n==="Currently Airing"?"text-green-400 border-green-400/30 bg-green-400/10":n==="Finished Airing"?"text-blue-400 border-blue-400/30 bg-blue-400/10":"text-text-secondary border-text-secondary/30 bg-text-secondary/10";return e.jsxs(B,{to:`/anime/${b}`,className:"group flex flex-col sm:flex-row gap-5 bg-bg-secondary border border-border-color rounded-xl p-4 hover:border-button-accent transition-all hover:shadow-lg hover:shadow-button-accent/5",children:[e.jsxs("div",{className:"shrink-0 w-full sm:w-32 aspect-[2/3] rounded-lg overflow-hidden relative",children:[e.jsx("img",{src:g,alt:d,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",loading:"lazy"}),e.jsxs("div",{className:"absolute top-1 right-1 bg-black/70 backdrop-blur-sm px-1.5 py-0.5 rounded text-xs font-bold text-white flex items-center gap-1",children:[e.jsx(H,{className:"w-3 h-3 text-yellow-400 fill-yellow-400"})," ",p]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-text-primary group-hover:text-button-accent transition-colors line-clamp-1",children:d}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-2 mt-2 text-sm text-text-secondary",children:[h&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"w-3.5 h-3.5"})," ",h]}),x&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"w-3.5 h-3.5"})," ",x]}),s&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(I,{className:"w-3.5 h-3.5"})," ",s," eps"]}),u&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(U,{className:"w-3.5 h-3.5"})," ",u.toLocaleString()]})]})]}),n&&e.jsx("span",{className:`px-2 py-1 rounded-md border text-xs font-bold uppercase tracking-wider whitespace-nowrap ${j}`,children:n==="Currently Airing"?"LanÃ§ando":n==="Finished Airing"?"Completo":n})]}),e.jsx("div",{className:"my-3 flex flex-wrap gap-2",children:w.split(", ").map(i=>e.jsx("span",{className:"text-xs px-2 py-1 rounded bg-bg-tertiary text-text-secondary border border-border-color",children:i},i))}),e.jsx("p",{className:"text-text-secondary text-sm leading-relaxed mb-4 line-clamp-3",children:f||"Sem sinopse disponÃ­vel."})]})]})}function ee(){const[b,d]=c.useState([]),[g,p]=c.useState(!0),[a,n]=c.useState(1),[u,x]=c.useState(!0),[s,h]=c.useState({q:"",genres:[],orderBy:"ranking",status:"",year:"",season:"",type:""}),w=c.useCallback(()=>{d([]),p(!0),n(1),x(!0),h({q:"",genres:[],orderBy:"ranking",status:"",year:"",season:"",type:""})},[]),f=(i,y)=>{d([]),p(!0),n(1),x(!0),h(N=>({...N,[i]:y}))};c.useEffect(()=>{let i=!0;const y=new AbortController;async function N(){try{p(!0),await new Promise(o=>setTimeout(o,600));const r=new URLSearchParams({page:a,limit:24,sfw:!0});let k="https://api.jikan.moe/v4/anime";const C=s.q!==""||s.genres.length>0,$=s.year||s.season||s.type,t=["ranking","score"].includes(s.orderBy);if(!C&&!s.status&&!$&&(t||s.orderBy==="popularity"||s.orderBy==="favorites"))k="https://api.jikan.moe/v4/top/anime",s.orderBy==="popularity"&&r.append("filter","bypopularity"),s.orderBy==="favorites"&&r.append("filter","favorite");else{if(k="https://api.jikan.moe/v4/anime",s.q&&r.append("q",s.q),s.status&&r.append("status",s.status),s.genres.length>0&&r.append("genres",s.genres.join(",")),s.type&&r.append("type",s.type),s.year){let o=`${s.year}-01-01`,m=`${s.year}-12-31`;if(s.season)switch(s.season){case"winter":o=`${s.year}-01-01`,m=`${s.year}-03-31`;break;case"spring":o=`${s.year}-04-01`,m=`${s.year}-06-30`;break;case"summer":o=`${s.year}-07-01`,m=`${s.year}-09-30`;break;case"fall":o=`${s.year}-10-01`,m=`${s.year}-12-31`;break}r.append("start_date",o),r.append("end_date",m)}switch(s.orderBy){case"ranking":case"score":r.append("order_by","score"),r.append("sort","desc");break;case"popularity":r.append("order_by","members"),r.append("sort","desc");break;case"favorites":r.append("order_by","favorites"),r.append("sort","desc");break;case"newest":r.append("order_by","start_date"),r.append("sort","desc");break;case"oldest":r.append("order_by","start_date"),r.append("sort","asc");break;case"az":r.append("order_by","title"),r.append("sort","asc");break;case"za":r.append("order_by","title"),r.append("sort","desc");break;default:r.append("order_by","score"),r.append("sort","desc")}}const l=await fetch(`${k}?${r.toString()}`,{signal:y.signal});if(!l.ok)throw new Error(`Status: ${l.status}`);const v=await l.json();if(!i)return;const S=v.data||[],T=v.pagination||{},A=S.map(o=>({id:o.mal_id,title:o.title_english||o.title,image:o.images?.jpg?.large_image_url||o.images?.jpg?.image_url,score:o.score||"N/A",genres:o.genres?o.genres.map(m=>m.name).slice(0,2).join(", "):"",synopsis:o.synopsis,status:o.status,members:o.members,year:o.year||o.aired?.prop?.from?.year,episodes:o.episodes,type:o.type}));d(o=>{if(a===1)return A;const m=[...o,...A];return Array.from(new Map(m.map(F=>[F.id,F])).values())}),x(T.has_next_page||S.length>0&&S.length>=24)}catch(r){r.name!=="AbortError"&&console.error("Erro fetch:",r)}finally{i&&p(!1)}}return N(),()=>{i=!1,y.abort()}},[a,s]);const j=c.useCallback(()=>{!g&&u&&n(i=>i+1)},[g,u]);return{animes:b,loading:g,loadMore:j,hasMore:u,filters:s,updateFilter:f,clearFilters:w}}const te=[{id:1,name:"AÃ§Ã£o"},{id:2,name:"Aventura"},{id:4,name:"ComÃ©dia"},{id:8,name:"Drama"},{id:10,name:"Fantasia"},{id:14,name:"Terror"},{id:22,name:"Romance"},{id:24,name:"Sci-Fi"},{id:7,name:"MistÃ©rio"},{id:40,name:"PsicolÃ³gico"},{id:18,name:"Mecha"},{id:19,name:"Musical"},{id:36,name:"Slice of Life"},{id:37,name:"Sobrenatural"},{id:30,name:"Esportes"},{id:41,name:"Suspense"},{id:23,name:"Escolar"},{id:42,name:"Seinen"},{id:27,name:"Shounen"}];function ce(){const{animes:b,loading:d,loadMore:g,hasMore:p,filters:a,updateFilter:n,clearFilters:u}=ee(),x=c.useRef(null),[s,h]=c.useState(!1),w=P(),[f,j]=c.useState(!1),[i,y]=c.useState("grid");O("CatÃ¡logo");const N=async()=>{try{j(!0),await new Promise(S=>setTimeout(S,800));const t=await fetch("https://api.jikan.moe/v4/random/anime");if(!t.ok)throw new Error("Erro ao buscar anime aleatÃ³rio");const v=(await t.json()).data.mal_id;w(`/anime/${v}`)}catch(t){console.error("Erro no 'Estou com sorte':",t),j(!1)}};c.useEffect(()=>{const t=new IntersectionObserver(l=>{l[0].isIntersecting&&p&&!d&&g()},{rootMargin:"200px"});return x.current&&t.observe(x.current),()=>t.disconnect()},[p,d,g]);const r=t=>{n("status",a.status===t?"":t)},k=t=>{const l=a.genres;l.includes(t)?n("genres",l.filter(v=>v!==t)):n("genres",[...l,t])},C=a.q||a.status||a.genres.length>0||a.year||a.season||a.type,$=b.length===0?12:4;return e.jsxs("div",{className:"flex h-screen overflow-hidden bg-bg-primary text-text-primary font-sans",children:[e.jsx(R,{}),e.jsxs("main",{className:"flex-1 h-full overflow-y-auto relative scrollbar-thin scrollbar-thumb-surface-dark scrollbar-track-bg-primary",children:[e.jsx(z,{}),e.jsxs("div",{className:"p-6 lg:p-10 max-w-[1600px] mx-auto",children:[e.jsxs("div",{className:"mb-8 border-b border-border-color pb-6",children:[e.jsx("h1",{className:"text-4xl font-black text-text-primary mb-2 tracking-tight",children:"CatÃ¡logo"}),e.jsx("p",{className:"text-lg text-text-secondary",children:"Descubra, filtre e encontre seus animes favoritos."})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsxs("aside",{className:V("lg:w-72 flex-shrink-0 space-y-8",s?"fixed inset-0 z-50 bg-bg-secondary p-6 overflow-y-auto":"hidden lg:block"),children:[e.jsxs("div",{className:"flex items-center justify-between lg:hidden mb-6 border-b border-border-color pb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Filtros"}),e.jsx("button",{onClick:()=>h(!1),className:"p-2 bg-bg-tertiary rounded-full text-text-primary",children:e.jsx(_,{})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-bold text-text-secondary uppercase tracking-wider flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-button-accent"})," Pesquisar"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:a.q,placeholder:"Ex: Naruto, Bleach...",className:"w-full bg-bg-secondary border-2 border-border-color rounded-xl px-4 py-3 text-base text-text-primary focus:outline-none focus:border-button-accent focus:ring-4 focus:ring-button-accent/10 transition-all placeholder-text-secondary/60",onChange:t=>n("q",t.target.value)}),a.q&&e.jsx("button",{onClick:()=>n("q",""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-secondary hover:text-text-primary p-1",children:e.jsx(_,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-bold text-text-secondary uppercase tracking-wider flex items-center gap-2",children:["  ",e.jsx(q,{className:"w-3.5 h-3.5 text-button-accent"})," Ano "]}),e.jsxs("select",{value:a.year,onChange:t=>n("year",t.target.value),className:"w-full bg-bg-secondary border-2 border-border-color rounded-xl px-2 py-2.5 text-sm text-text-primary focus:outline-none focus:border-button-accent focus:ring-2 focus:ring-button-accent/10 transition-all cursor-pointer appearance-none",children:[e.jsx("option",{value:"",children:"Todos"}),Array.from({length:45},(t,l)=>new Date().getFullYear()+1-l).map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-bold text-text-secondary uppercase tracking-wider flex items-center gap-2",children:" Temp. "}),e.jsxs("select",{value:a.season,onChange:t=>n("season",t.target.value),className:"w-full bg-bg-secondary border-2 border-border-color rounded-xl px-2 py-2.5 text-sm text-text-primary focus:outline-none focus:border-button-accent focus:ring-2 focus:ring-button-accent/10 transition-all cursor-pointer appearance-none",children:[e.jsx("option",{value:"",children:"Todas"}),e.jsx("option",{value:"winter",children:"Inverno"}),e.jsx("option",{value:"spring",children:"Primavera"}),e.jsx("option",{value:"summer",children:"VerÃ£o"}),e.jsx("option",{value:"fall",children:"Outono"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-bold text-text-secondary uppercase tracking-wider flex items-center gap-2",children:[" ",e.jsx(L,{className:"w-3.5 h-3.5 text-button-accent"})," Formato "]}),e.jsxs("select",{value:a.type,onChange:t=>n("type",t.target.value),className:"w-full bg-bg-secondary border-2 border-border-color rounded-xl px-3 py-2.5 text-sm text-text-primary focus:outline-none focus:border-button-accent focus:ring-2 focus:ring-button-accent/10 transition-all cursor-pointer",children:[e.jsx("option",{value:"",children:"Todos os formatos"}),e.jsx("option",{value:"tv",children:"TV (SÃ©ries)"}),e.jsx("option",{value:"movie",children:"Filmes"}),e.jsx("option",{value:"ova",children:"OVAs"}),e.jsx("option",{value:"special",children:"Especiais"}),e.jsx("option",{value:"ona",children:"ONAs (Internet)"}),e.jsx("option",{value:"music",children:"Musical"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-bold text-text-secondary uppercase tracking-wider flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-button-accent"})," Status"]}),e.jsx("div",{className:"flex flex-col gap-2",children:[{val:"airing",label:"Em LanÃ§amento",color:"bg-green-500"},{val:"complete",label:"Completo",color:"bg-blue-500"},{val:"upcoming",label:"Em Breve",color:"bg-purple-500"}].map(t=>e.jsxs("div",{onClick:()=>r(t.val),className:`
                            flex items-center gap-3 px-4 py-3 rounded-xl cursor-pointer transition-all border-2
                            ${a.status===t.val?"bg-bg-secondary border-button-accent text-text-primary shadow-lg shadow-button-accent/10":"bg-bg-secondary/50 border-transparent hover:bg-bg-secondary hover:border-border-color text-text-secondary hover:text-text-primary"}
                        `,children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${a.status===t.val?t.color:"bg-gray-600"}`}),e.jsx("span",{className:"font-medium",children:t.label})]},t.val))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-bold text-text-secondary uppercase tracking-wider flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-button-accent"})," GÃªneros"]}),a.genres.length>0&&e.jsx("span",{className:"text-xs bg-button-accent text-text-on-primary font-bold px-2 py-0.5 rounded-full",children:a.genres.length})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:te.map(t=>{const l=a.genres.includes(t.id);return e.jsx("button",{onClick:()=>k(t.id),className:`
                            text-sm px-4 py-2 rounded-lg border transition-all font-medium
                            ${l?"bg-button-accent border-button-accent text-text-on-primary shadow-md shadow-button-accent/20":"bg-bg-secondary border-border-color text-text-secondary hover:border-border-color/80 hover:text-text-primary hover:bg-bg-tertiary"}
                        `,children:t.name},t.id)})})]}),e.jsxs("button",{onClick:N,disabled:f,className:"w-full flex items-center justify-center gap-2 py-4 rounded-xl bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white shadow-lg shadow-purple-500/20 transition-all text-sm font-bold uppercase tracking-wider relative overflow-hidden group",children:[e.jsx("div",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"}),e.jsx(X,{className:`w-4 h-4 ${f?"animate-spin":""}`}),f?"Sorteando...":"Estou com Sorte"]}),C&&e.jsxs("button",{onClick:u,className:"w-full flex items-center justify-center gap-2 py-4 rounded-xl bg-red-500/10 border border-red-500/20 text-red-400 hover:bg-red-500/20 hover:text-red-300 transition-all text-sm font-bold uppercase tracking-wider",children:[e.jsx(Y,{className:"w-4 h-4"})," Limpar Filtros"]})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-8 p-5 bg-bg-secondary border border-border-color rounded-2xl shadow-xl shadow-shadow-color/10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>h(!0),className:"lg:hidden p-2.5 bg-button-accent text-text-on-primary rounded-lg shadow-lg shadow-button-accent/20",children:e.jsx(M,{className:"w-5 h-5"})}),e.jsxs("span",{className:"text-base text-text-secondary",children:["Encontrados: ",e.jsx("strong",{className:"text-text-primary text-lg",children:b.length})," animes"]})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsxs("div",{className:"flex bg-bg-tertiary rounded-xl p-1 border border-border-color",children:[e.jsx("button",{onClick:()=>y("grid"),className:`p-2 rounded-lg transition-all ${i==="grid"?"bg-bg-secondary text-button-accent shadow-sm":"text-text-secondary hover:text-text-primary"}`,children:e.jsx(J,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>y("list"),className:`p-2 rounded-lg transition-all ${i==="list"?"bg-bg-secondary text-button-accent shadow-sm":"text-text-secondary hover:text-text-primary"}`,children:e.jsx(K,{className:"w-5 h-5"})})]}),e.jsx("span",{className:"text-sm font-medium text-text-secondary hidden sm:inline whitespace-nowrap pl-2 border-l border-border-color",children:"Ordenar por:"}),e.jsxs("div",{className:"relative group w-full sm:w-auto",children:[e.jsxs("select",{className:"w-full sm:w-auto appearance-none bg-bg-tertiary border-2 border-border-color text-text-primary pl-4 pr-12 py-2.5 rounded-xl text-sm font-medium focus:outline-none focus:border-button-accent focus:ring-2 focus:ring-button-accent/20 cursor-pointer hover:bg-bg-secondary transition-all",value:a.orderBy,onChange:t=>n("orderBy",t.target.value),children:[e.jsxs("optgroup",{label:"Destaques",children:[e.jsx("option",{value:"ranking",children:"ðŸ† Top Ranking (Geral)"}),e.jsx("option",{value:"popularity",children:"ðŸ”¥ Mais Populares"}),e.jsx("option",{value:"favorites",children:"â¤ï¸ Mais Favoritados"})]}),e.jsxs("optgroup",{label:"Outros",children:[e.jsx("option",{value:"score",children:"â­ Melhor Nota (Filtro)"}),e.jsx("option",{value:"newest",children:"ðŸ“… LanÃ§amentos Recentes"}),e.jsx("option",{value:"az",children:"ðŸ”¤ Ordem AlfabÃ©tica (A-Z)"}),e.jsx("option",{value:"za",children:"ðŸ”¤ Ordem AlfabÃ©tica (Z-A)"})]})]}),e.jsx(Q,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-text-secondary pointer-events-none"})]})]})]}),e.jsxs("div",{className:i==="grid"?"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6":"flex flex-col gap-4",children:[b.map(t=>i==="grid"?e.jsx(G,{...t},`${t.id}-${a.orderBy}`):e.jsx(W,{...t},`${t.id}-${a.orderBy}`)),d&&Array.from({length:$}).map((t,l)=>i==="grid"?e.jsx(D,{},`skeleton-${l}`):e.jsx("div",{className:"h-48 bg-bg-secondary rounded-xl animate-pulse"},`skeleton-${l}`))]}),!d&&b.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-bg-secondary rounded-full flex items-center justify-center mb-6 shadow-inner",children:e.jsx(E,{className:"w-10 h-10 text-text-secondary"})}),e.jsx("h3",{className:"text-2xl font-bold text-text-primary mb-2",children:"Nenhum resultado encontrado"}),e.jsx("p",{className:"text-text-secondary mb-6",children:"Tente usar outros termos ou limpe os filtros."}),e.jsx("button",{onClick:u,className:"px-6 py-3 bg-button-accent hover:bg-button-accent/90 text-text-on-primary rounded-xl font-bold transition-all shadow-lg shadow-button-accent/20",children:"Limpar todos os filtros"})]}),e.jsx("div",{ref:x,className:"h-10 mt-8"})]})]})]})]})]})}export{ce as Catalog};
