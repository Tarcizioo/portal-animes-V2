import{j as e,u as E,a as z,L as V,q as M}from"./index-CPSkf6_A.js";import{r as t,f as G,L as J}from"./vendor-CzuZ2vSz.js";import{L as S}from"./Layout-B3H3bNmt.js";import{u as D}from"./useCharacterLibrary-BNiiRWUI.js";import{u as q}from"./usePageTitle-XJJnLCUf.js";import{$ as H,a0 as I,H as F,I as O,a1 as U,a2 as W,F as B,m as X,a3 as A,X as L}from"./ui-DGQG60Ii.js";import"./firebase-sbJdvLJZ.js";function K(o){const[a,h]=t.useState(null),[n,i]=t.useState([]),[p,c]=t.useState([]),[l,u]=t.useState([]),[g,d]=t.useState(!0);return t.useEffect(()=>{if(!o)return;async function w(){try{d(!0),await new Promise(y=>setTimeout(y,300));const[b,f,N,j]=await Promise.all([fetch(`https://api.jikan.moe/v4/characters/${o}/full`),fetch(`https://api.jikan.moe/v4/characters/${o}/anime`),fetch(`https://api.jikan.moe/v4/characters/${o}/voices`),fetch(`https://api.jikan.moe/v4/characters/${o}/pictures`)]),m=await b.json(),k=await f.json(),C=await N.json(),v=await j.json(),s=m.data,_={id:s.mal_id,name:s.name,name_kanji:s.name_kanji,about:s.about,favorites:s.favorites,image:s.images?.jpg?.image_url,large_image:s.images?.jpg?.large_image_url||s.images?.jpg?.image_url,url:s.url,nicknames:s.nicknames||[]};h(_),i(k.data||[]),c(C.data||[]),u(v.data||[])}catch(b){console.error("Error loading character details:",b)}finally{d(!1)}}w()},[o]),{character:a,animeography:n,voiceActors:p,pictures:l,loading:g}}function Q({items:o,title:a,icon:h,renderItem:n}){const i=t.useRef(null),p=c=>{if(i.current){const{current:l}=i,u=c==="left"?-l.offsetWidth:l.offsetWidth;l.scrollBy({left:u,behavior:"smooth"})}};return!o||o.length===0?null:e.jsxs("div",{className:"relative group/carousel",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-1",children:[a&&e.jsxs("h3",{className:"text-2xl font-black text-text-primary flex items-center gap-3",children:[h&&e.jsx("span",{className:"p-2 mr-1 bg-gradient-to-br from-primary/20 to-primary/5 rounded-lg text-primary",children:e.jsx(h,{className:"w-6 h-6"})}),a]}),e.jsxs("div",{className:"flex gap-2 opacity-0 group-hover/carousel:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>p("left"),className:"p-2 rounded-full bg-bg-secondary hover:bg-primary hover:text-white transition-colors border border-border-color",children:e.jsx(H,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>p("right"),className:"p-2 rounded-full bg-bg-secondary hover:bg-primary hover:text-white transition-colors border border-border-color",children:e.jsx(I,{className:"w-5 h-5"})})]})]}),e.jsx("div",{ref:i,className:"flex gap-4 overflow-x-auto pb-4 snap-x snap-mandatory [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:o.map((c,l)=>e.jsx("div",{className:"snap-start shrink-0",children:n?n(c):e.jsx("div",{className:"w-[200px] h-[300px] bg-bg-secondary rounded-xl"})},l))})]})}function oe(){const{id:o}=G(),{character:a,animeography:h,voiceActors:n,pictures:i,loading:p}=K(o),{isCharacterFavorite:c,toggleCharacterFavorite:l}=D(),{user:u}=E(),{toast:g}=z(),[d,w]=t.useState(!1),[b,f]=t.useState(!1),[N,j]=t.useState(!1),m=a?c(a.id):!1,k=async()=>{if(!u){g.error("Faça login para favoritar!");return}j(!0),setTimeout(()=>j(!1),500),f(!0);try{await l(a),m?g.info(`${a.name} removido dos favoritos.`,"Favorito Removido"):g.success(`${a.name} adicionado aos favoritos!`,"Favorito Adicionado")}catch(r){g.error(r.message,"Erro ao Favoritar")}finally{f(!1)}};q(a?.name||"Detalhes do Personagem");const C=r=>r?r>1e3?(r/1e3).toFixed(1)+"k":r.toString():"0",[v,s]=t.useState(null),[_,y]=t.useState(!1),[P,R]=t.useState(!1);if(t.useEffect(()=>{const r=setTimeout(()=>R(!0),100);return()=>clearTimeout(r)},[]),p)return e.jsx(S,{children:e.jsx("div",{className:"flex h-[80vh] items-center justify-center",children:e.jsx(V,{})})});if(!a)return e.jsx(S,{children:e.jsx("div",{className:"flex bg-bg-primary text-text-primary items-center justify-center h-screen",children:e.jsx("p",{children:"Personagem não encontrado."})})});const $=n.filter(r=>r.language==="Japanese").slice(0,4),T=$.length>0?$:n.slice(0,4);return e.jsxs(S,{children:[e.jsx(M,{}),e.jsxs("div",{className:"min-h-screen bg-bg-primary text-text-primary font-sans pb-20 relative overflow-hidden",children:[e.jsx("div",{className:`relative z-10 max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-10 py-12 transition-opacity duration-700 ${P?"opacity-100":"opacity-0"}`,children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10",children:[e.jsxs("aside",{className:"lg:col-span-3 lg:sticky lg:top-24 h-fit space-y-6",children:[e.jsxs("div",{className:"relative rounded-2xl overflow-hidden shadow-2xl border-4 border-white/5 bg-bg-secondary aspect-[2/3] group",children:[e.jsx("img",{src:a.image,alt:a.name,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-60"}),a.favorites&&e.jsxs("div",{className:"absolute top-3 left-3 px-3 py-1.5 bg-black/60 backdrop-blur-md rounded-xl text-xs font-bold text-white border border-white/10 shadow-lg flex items-center gap-1.5",children:[e.jsx(F,{className:`w-3.5 h-3.5 ${m?"text-red-500 fill-red-500":"text-gray-300"}`}),C(a.favorites)]})]}),a.nicknames?.length>0&&e.jsxs("div",{className:"bg-bg-secondary/50 backdrop-blur-md rounded-2xl p-5 border border-white/5 space-y-3",children:[e.jsxs("h3",{className:"font-bold border-b border-white/5 pb-2 flex items-center gap-2 text-sm text-text-secondary uppercase tracking-wider",children:[e.jsx(O,{className:"w-4 h-4"})," Apelidos"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.nicknames.slice(0,5).map((r,x)=>e.jsx("span",{className:"text-xs font-medium px-2 py-1 bg-white/5 rounded-md border border-white/5 text-text-primary",children:r},x))})]})]}),e.jsxs("div",{className:"lg:col-span-9 space-y-10",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-4xl md:text-6xl font-black text-text-primary tracking-tight drop-shadow-2xl leading-none",children:a.name}),a.name_kanji&&e.jsx("h2",{className:"text-2xl text-primary font-bold opacity-80",children:a.name_kanji})]}),e.jsxs("button",{onClick:()=>k(),disabled:b,className:`flex items-center gap-2 px-6 py-3 rounded-full font-bold transition-all duration-300 shadow-xl active:scale-95 group border ${m?"bg-red-500 text-white border-red-400":"bg-white/10 text-white hover:bg-white/20 border-white/10"}`,children:[e.jsx(F,{className:`w-5 h-5 transition-transform duration-300 ${m?"fill-white":""} ${N?"scale-150":"group-hover:scale-110"}`}),e.jsx("span",{children:m?"Favoritado":"Favoritar"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-3 border-b border-white/10 pb-4 mb-4",children:e.jsxs("h3",{className:"text-2xl font-bold text-text-primary flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5 text-primary"})," Sobre"]})}),e.jsxs("div",{className:"prose prose-invert max-w-none",children:[e.jsx("p",{className:"text-text-secondary leading-relaxed whitespace-pre-line text-base md:text-lg font-light",children:a.about?d?a.about.replace(/\\n/g,`
`):a.about.replace(/\\n/g,`
`).slice(0,600)+(a.about.length>600?"...":""):"Sem descrição disponível para este personagem."}),a.about&&a.about.length>600&&e.jsxs("button",{onClick:()=>w(!d),className:"mt-2 text-primary font-bold hover:text-white transition-colors text-sm flex items-center gap-1 group",children:[d?"Ler Menos":"Ler Mais"," ",e.jsx(I,{className:`w-4 h-4 transition-transform ${d?"rotate-90":""}`})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-bold mb-6 flex items-center gap-3",children:[e.jsx(W,{className:"w-6 h-6 text-primary"})," Dubladores"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4",children:[T.map((r,x)=>e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl bg-bg-secondary border border-border-color hover:border-primary/50 hover:bg-bg-tertiary transition-all group",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-cover bg-center shrink-0 border-2 border-white/10 group-hover:border-primary transition-all shadow-md",style:{backgroundImage:`url('${r.person.images?.jpg?.image_url}')`}}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h4",{className:"text-base font-bold text-text-primary truncate group-hover:text-primary transition-colors",children:r.person.name}),e.jsx("span",{className:"text-xs font-bold text-text-secondary uppercase tracking-wider bg-black/20 px-2 py-0.5 rounded-full",children:r.language})]})]},`${r.person.mal_id}-${x}`)),n.length===0&&e.jsx("span",{className:"text-gray-500 italic",children:"Nenhum dublador registrado."})]})]}),e.jsx("div",{className:"bg-bg-secondary/20 p-6 rounded-3xl border border-white/5",children:e.jsx(Q,{title:"Filmografia",icon:B,items:h,renderItem:r=>e.jsxs(J,{to:`/anime/${r.anime.mal_id}`,className:"block w-[140px] md:w-[160px] group relative",children:[e.jsxs("div",{className:"relative aspect-[2/3] rounded-xl overflow-hidden shadow-lg border border-white/5 group-hover:border-primary/50 transition-all",children:[e.jsx("img",{src:r.anime.images?.jpg?.image_url,alt:r.anime.title,loading:"lazy",className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}),e.jsx("div",{className:"absolute top-1.5 right-1.5",children:e.jsx("span",{className:X("text-[10px] font-black px-2 py-1 rounded-md shadow-sm backdrop-blur-md uppercase tracking-wide",r.role==="Main"?"bg-primary text-white":"bg-black/60 text-gray-200"),children:r.role==="Main"?"MAIN":"SUPP"})})]}),e.jsx("h4",{className:"text-sm font-bold text-text-primary group-hover:text-primary transition-colors line-clamp-2 mt-3 leading-tight",children:r.anime.title})]})})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-2xl font-bold flex items-center gap-3",children:[e.jsx(A,{className:"w-6 h-6 text-primary"})," Galeria"]}),i.length>4&&e.jsxs("button",{onClick:()=>y(!0),className:"text-sm font-bold text-primary hover:text-white hover:bg-primary px-4 py-2 rounded-xl transition-all border border-primary/20 hover:border-transparent",children:["Ver Tudo (",i.length,")"]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:i.slice(0,4).map((r,x)=>e.jsxs("div",{className:"aspect-square rounded-2xl overflow-hidden cursor-pointer group relative border border-white/5 hover:border-primary/50 transition-all shadow-md hover:shadow-primary/20",onClick:()=>s(r.jpg.image_url),children:[e.jsx("img",{src:r.jpg.image_url,alt:"Character gallery",loading:"lazy",className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}),e.jsx("div",{className:"absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity"})]},x))})]})]})]})}),_&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/95 animate-in fade-in duration-200 p-4",children:e.jsxs("div",{className:"w-full h-full flex flex-col max-w-7xl mx-auto bg-bg-primary rounded-3xl overflow-hidden shadow-2xl border border-white/10",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-border-color bg-bg-secondary",children:[e.jsxs("h2",{className:"text-2xl font-bold text-text-primary flex items-center gap-2",children:[e.jsx(A,{className:"w-6 h-6 text-primary"})," Galeria Completa"]}),e.jsx("button",{onClick:()=>y(!1),className:"p-2 bg-bg-tertiary hover:bg-red-500 hover:text-white rounded-full text-text-primary transition-colors",children:e.jsx(L,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6 scrollbar-thin scrollbar-thumb-primary/50 scrollbar-track-bg-secondary",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6",children:i.map((r,x)=>e.jsx("div",{className:"aspect-[2/3] rounded-xl overflow-hidden cursor-pointer group relative border border-white/10 hover:border-primary transition-all shadow-lg hover:shadow-primary/20",onClick:()=>s(r.jpg.image_url),children:e.jsx("img",{src:r.jpg.image_url,alt:"Gallery full",loading:"lazy",className:"w-full h-full object-cover hover:scale-105 transition-transform duration-500"})},x))})})]})}),v&&e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/95 backdrop-blur-xl p-4 animate-in fade-in duration-200",onClick:()=>s(null),children:[e.jsx("img",{src:v,alt:"Full size",className:"max-w-full max-h-[90vh] rounded-2xl shadow-2xl object-contain border-4 border-white/10"}),e.jsx("button",{className:"absolute top-6 right-6 p-3 bg-white/10 hover:bg-red-500 rounded-full text-white transition-colors backdrop-blur-md",onClick:r=>{r.stopPropagation(),s(null)},children:e.jsx(L,{className:"w-8 h-8"})})]})]})]})}export{oe as CharacterDetails};
