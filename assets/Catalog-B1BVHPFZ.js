import{c as A,j as l,l as e,X as C}from"./index-9QzYO_Vw.js";import{S as z,H as $,c as L,b as _,T as R}from"./Header-BPBXdXKG.js";import{A as T,S as H}from"./SkeletonCard-BAvYKwAm.js";import{C as G}from"./chevron-down-CJoN5EEz.js";import"./house--t-cFmYR.js";import"./star-DVuyzshP.js";const O=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],q=A("funnel",O);const P=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],D=A("sliders-horizontal",P);function Z(){const[u,d]=l.useState([]),[m,p]=l.useState(!0),[a,c]=l.useState(1),[b,x]=l.useState(!0),[r,h]=l.useState({q:"",genres:[],orderBy:"ranking",status:""}),g=l.useCallback(()=>{d([]),p(!0),c(1),x(!0),h({q:"",genres:[],orderBy:"ranking",status:""})},[]),f=(i,t)=>{d([]),p(!0),c(1),x(!0),h(n=>({...n,[i]:t}))};l.useEffect(()=>{let i=!0;const t=new AbortController;async function n(){try{p(!0),await new Promise(o=>setTimeout(o,600));const s=new URLSearchParams({page:a,limit:24,sfw:!0});let j="https://api.jikan.moe/v4/anime";const F=r.q!==""||r.genres.length>0,E=["ranking","score"].includes(r.orderBy);if(!F&&!r.status&&(E||r.orderBy==="popularity"||r.orderBy==="favorites"))j="https://api.jikan.moe/v4/top/anime",r.orderBy==="popularity"&&s.append("filter","bypopularity"),r.orderBy==="favorites"&&s.append("filter","favorite");else switch(j="https://api.jikan.moe/v4/anime",r.q&&s.append("q",r.q),r.status&&s.append("status",r.status),r.genres.length>0&&s.append("genres",r.genres.join(",")),r.orderBy){case"ranking":case"score":s.append("order_by","score"),s.append("sort","desc");break;case"popularity":s.append("order_by","members"),s.append("sort","desc");break;case"favorites":s.append("order_by","favorites"),s.append("sort","desc");break;case"newest":s.append("order_by","start_date"),s.append("sort","desc");break;case"oldest":s.append("order_by","start_date"),s.append("sort","asc");break;case"az":s.append("order_by","title"),s.append("sort","asc");break;case"za":s.append("order_by","title"),s.append("sort","desc");break;default:s.append("order_by","score"),s.append("sort","desc")}const v=await fetch(`${j}?${s.toString()}`,{signal:t.signal});if(!v.ok)throw new Error(`Status: ${v.status}`);const k=await v.json();if(!i)return;const w=k.data||[],B=k.pagination||{},M=w.map(o=>({id:o.mal_id,title:o.title_english||o.title,image:o.images?.jpg?.large_image_url||o.images?.jpg?.image_url,score:o.score||"N/A",genres:o.genres?o.genres.map(N=>N.name).slice(0,2).join(", "):""}));d(o=>{if(a===1)return M;const N=[...o,...M];return Array.from(new Map(N.map(S=>[S.id,S])).values())}),x(B.has_next_page||w.length>0&&w.length>=24)}catch(s){s.name!=="AbortError"&&console.error("Erro fetch:",s)}finally{i&&p(!1)}}return n(),()=>{i=!1,t.abort()}},[a,r]);const y=l.useCallback(()=>{!m&&b&&c(i=>i+1)},[m,b]);return{animes:u,loading:m,loadMore:y,hasMore:b,filters:r,updateFilter:f,clearFilters:g}}const I=[{id:1,name:"AÃ§Ã£o"},{id:2,name:"Aventura"},{id:4,name:"ComÃ©dia"},{id:8,name:"Drama"},{id:10,name:"Fantasia"},{id:14,name:"Terror"},{id:22,name:"Romance"},{id:24,name:"Sci-Fi"},{id:36,name:"Slice of Life"},{id:37,name:"Sobrenatural"},{id:30,name:"Esportes"},{id:41,name:"Suspense"}];function V(){const{animes:u,loading:d,loadMore:m,hasMore:p,filters:a,updateFilter:c,clearFilters:b}=Z(),x=l.useRef(null),[r,h]=l.useState(!1);l.useEffect(()=>{const t=new IntersectionObserver(n=>{n[0].isIntersecting&&p&&!d&&m()},{rootMargin:"200px"});return x.current&&t.observe(x.current),()=>t.disconnect()},[p,d,m]);const g=t=>{c("status",a.status===t?"":t)},f=t=>{const n=a.genres;n.includes(t)?c("genres",n.filter(s=>s!==t)):c("genres",[...n,t])},y=a.q||a.status||a.genres.length>0,i=u.length===0?12:4;return e.jsxs("div",{className:"flex h-screen overflow-hidden bg-bg-primary text-text-primary font-sans",children:[e.jsx(z,{}),e.jsxs("main",{className:"flex-1 h-full overflow-y-auto relative scrollbar-thin scrollbar-thumb-surface-dark scrollbar-track-bg-primary",children:[e.jsx($,{}),e.jsxs("div",{className:"p-6 lg:p-10 max-w-[1600px] mx-auto",children:[e.jsxs("div",{className:"mb-8 border-b border-border-color pb-6",children:[e.jsx("h1",{className:"text-4xl font-black text-text-primary mb-2 tracking-tight",children:"CatÃ¡logo"}),e.jsx("p",{className:"text-lg text-text-secondary",children:"Descubra, filtre e encontre seus animes favoritos."})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsxs("aside",{className:L("lg:w-72 flex-shrink-0 space-y-8",r?"fixed inset-0 z-50 bg-bg-secondary p-6 overflow-y-auto":"hidden lg:block"),children:[e.jsxs("div",{className:"flex items-center justify-between lg:hidden mb-6 border-b border-border-color pb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Filtros"}),e.jsx("button",{onClick:()=>h(!1),className:"p-2 bg-bg-tertiary rounded-full text-text-primary",children:e.jsx(C,{})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-bold text-text-secondary uppercase tracking-wider flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-button-accent"})," Pesquisar"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:a.q,placeholder:"Ex: Naruto, Bleach...",className:"w-full bg-bg-secondary border-2 border-border-color rounded-xl px-4 py-3 text-base text-text-primary focus:outline-none focus:border-button-accent focus:ring-4 focus:ring-button-accent/10 transition-all placeholder-text-secondary/60",onChange:t=>c("q",t.target.value)}),a.q&&e.jsx("button",{onClick:()=>c("q",""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-secondary hover:text-text-primary p-1",children:e.jsx(C,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-bold text-text-secondary uppercase tracking-wider flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-button-accent"})," Status"]}),e.jsx("div",{className:"flex flex-col gap-2",children:[{val:"airing",label:"Em LanÃ§amento",color:"bg-green-500"},{val:"complete",label:"Completo",color:"bg-blue-500"},{val:"upcoming",label:"Em Breve",color:"bg-purple-500"}].map(t=>e.jsxs("div",{onClick:()=>g(t.val),className:`
                            flex items-center gap-3 px-4 py-3 rounded-xl cursor-pointer transition-all border-2
                            ${a.status===t.val?"bg-bg-secondary border-button-accent text-text-primary shadow-lg shadow-button-accent/10":"bg-bg-secondary/50 border-transparent hover:bg-bg-secondary hover:border-border-color text-text-secondary hover:text-text-primary"}
                        `,children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${a.status===t.val?t.color:"bg-gray-600"}`}),e.jsx("span",{className:"font-medium",children:t.label})]},t.val))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-bold text-text-secondary uppercase tracking-wider flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-button-accent"})," GÃªneros"]}),a.genres.length>0&&e.jsx("span",{className:"text-xs bg-button-accent text-text-on-primary font-bold px-2 py-0.5 rounded-full",children:a.genres.length})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:I.map(t=>{const n=a.genres.includes(t.id);return e.jsx("button",{onClick:()=>f(t.id),className:`
                            text-sm px-4 py-2 rounded-lg border transition-all font-medium
                            ${n?"bg-button-accent border-button-accent text-text-on-primary shadow-md shadow-button-accent/20":"bg-bg-secondary border-border-color text-text-secondary hover:border-border-color/80 hover:text-text-primary hover:bg-bg-tertiary"}
                        `,children:t.name},t.id)})})]}),y&&e.jsxs("button",{onClick:b,className:"w-full flex items-center justify-center gap-2 py-4 rounded-xl bg-red-500/10 border border-red-500/20 text-red-400 hover:bg-red-500/20 hover:text-red-300 transition-all text-sm font-bold uppercase tracking-wider",children:[e.jsx(R,{className:"w-4 h-4"})," Limpar Filtros"]})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-8 p-5 bg-bg-secondary border border-border-color rounded-2xl shadow-xl shadow-shadow-color/10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>h(!0),className:"lg:hidden p-2.5 bg-button-accent text-text-on-primary rounded-lg shadow-lg shadow-button-accent/20",children:e.jsx(q,{className:"w-5 h-5"})}),e.jsxs("span",{className:"text-base text-text-secondary",children:["Encontrados: ",e.jsx("strong",{className:"text-text-primary text-lg",children:u.length})," animes"]})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsx("span",{className:"text-sm font-medium text-text-secondary hidden sm:inline whitespace-nowrap",children:"Ordenar por:"}),e.jsxs("div",{className:"relative group w-full sm:w-auto",children:[e.jsxs("select",{className:"w-full sm:w-auto appearance-none bg-bg-tertiary border-2 border-border-color text-text-primary pl-4 pr-12 py-2.5 rounded-xl text-sm font-medium focus:outline-none focus:border-button-accent focus:ring-2 focus:ring-button-accent/20 cursor-pointer hover:bg-bg-secondary transition-all",value:a.orderBy,onChange:t=>c("orderBy",t.target.value),children:[e.jsxs("optgroup",{label:"Destaques",children:[e.jsx("option",{value:"ranking",children:"ðŸ† Top Ranking (Geral)"}),e.jsx("option",{value:"popularity",children:"ðŸ”¥ Mais Populares"}),e.jsx("option",{value:"favorites",children:"â¤ï¸ Mais Favoritados"})]}),e.jsxs("optgroup",{label:"Outros",children:[e.jsx("option",{value:"score",children:"â­ Melhor Nota (Filtro)"}),e.jsx("option",{value:"newest",children:"ðŸ“… LanÃ§amentos Recentes"}),e.jsx("option",{value:"az",children:"ðŸ”¤ Ordem AlfabÃ©tica (A-Z)"}),e.jsx("option",{value:"za",children:"ðŸ”¤ Ordem AlfabÃ©tica (Z-A)"})]})]}),e.jsx(G,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-text-secondary pointer-events-none"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[u.map(t=>e.jsx(T,{...t},`${t.id}-${a.orderBy}`)),d&&Array.from({length:i}).map((t,n)=>e.jsx(H,{},`skeleton-${n}`))]}),!d&&u.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-bg-secondary rounded-full flex items-center justify-center mb-6 shadow-inner",children:e.jsx(_,{className:"w-10 h-10 text-text-secondary"})}),e.jsx("h3",{className:"text-2xl font-bold text-text-primary mb-2",children:"Nenhum resultado encontrado"}),e.jsx("p",{className:"text-text-secondary mb-6",children:"Tente usar outros termos ou limpe os filtros."}),e.jsx("button",{onClick:b,className:"px-6 py-3 bg-button-accent hover:bg-button-accent/90 text-text-on-primary rounded-xl font-bold transition-all shadow-lg shadow-button-accent/20",children:"Limpar todos os filtros"})]}),e.jsx("div",{ref:x,className:"h-10 mt-8"})]})]})]})]})]})}export{V as Catalog};
