import{a as T,j as e,m as a,A as F}from"./index-CPSkf6_A.js";import{r as n,L as M}from"./vendor-CzuZ2vSz.js";import{L as v}from"./Layout-B3H3bNmt.js";import{S as E,A as z}from"./SkeletonCard-BJMAUOE0.js";import{A as P}from"./AnimeListItem-DnRc0VUO.js";import{u as $}from"./useAnimeLibrary-thLaFgu-.js";import{u as B}from"./usePageTitle-XJJnLCUf.js";import{a5 as G,a6 as q,m as I,X as j,u as O,s as w,c as D,t as V,v as N,k as H,x as R,o as U,y as J}from"./ui-DGQG60Ii.js";import"./firebase-sbJdvLJZ.js";const Z=[{id:1,name:"A√ß√£o"},{id:2,name:"Aventura"},{id:4,name:"Com√©dia"},{id:8,name:"Drama"},{id:10,name:"Fantasia"},{id:14,name:"Terror"},{id:22,name:"Romance"},{id:24,name:"Sci-Fi"},{id:7,name:"Mist√©rio"},{id:40,name:"Psicol√≥gico"},{id:18,name:"Mecha"},{id:19,name:"Musical"},{id:36,name:"Slice of Life"},{id:37,name:"Sobrenatural"},{id:30,name:"Esportes"},{id:41,name:"Suspense"},{id:23,name:"Escolar"},{id:42,name:"Seinen"},{id:27,name:"Shounen"}],X={1:"Action",2:"Adventure",4:"Comedy",8:"Drama",10:"Fantasy",14:"Horror",22:"Romance",24:"Sci-Fi",7:"Mystery",40:"Psychological",18:"Mecha",19:"Music",36:"Slice of Life",37:"Supernatural",30:"Sports",41:"Suspense",56:"School",57:"Seinen",27:"Shounen"},Y={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}};function ne(){const{library:m,loading:S,syncLibraryData:C}=$(),[A,b]=n.useState(!1),[o,g]=n.useState(()=>localStorage.getItem("anime_lib_view_mode")||"grid"),[i,h]=n.useState(!1),{toast:u}=T();B("Minha Biblioteca"),n.useEffect(()=>{localStorage.setItem("anime_lib_view_mode",o)},[o]);const L=async()=>{if(!i){h(!0),u.info("Iniciando sincroniza√ß√£o de dados...");try{await C((s,t)=>{s%5}),u.success("Biblioteca sincronizada com sucesso!")}catch{u.error("Erro ao sincronizar dados.")}finally{h(!1)}}},[r,y]=n.useState(()=>{const s=localStorage.getItem("anime_lib_filters");if(s)try{return JSON.parse(s)}catch(t){console.error("Erro ao ler filtros do localStorage",t)}return{q:"",genres:[],orderBy:"recent_updated",status:"",libraryStatus:"",year:"",season:"",type:""}});n.useEffect(()=>{localStorage.setItem("anime_lib_filters",JSON.stringify(r))},[r]);const d=n.useMemo(()=>m?m.filter(s=>{if(r.q&&!s.title.toLowerCase().includes(r.q.toLowerCase())||r.libraryStatus&&s.status!==r.libraryStatus||r.type&&(s.type||"TV").toLowerCase()!==r.type.toLowerCase()||r.season&&(s.season||"").toLowerCase()!==r.season.toLowerCase()||r.year&&s.year!==parseInt(r.year))return!1;if(r.genres.length>0){let t=[];if(Array.isArray(s.genres)?t=s.genres:typeof s.genres=="string"&&(t=s.genres.split(",").map(c=>c.trim())),!r.genres.map(c=>X[c]).filter(Boolean).some(c=>t.some(k=>k.toLowerCase().trim()===c.toLowerCase().trim())))return!1}return!0}).sort((s,t)=>{switch(r.orderBy){case"score":return(t.score||0)-(s.score||0);case"title_asc":return s.title.localeCompare(t.title);case"title_desc":return t.title.localeCompare(s.title);case"recent_updated":return(t.lastUpdated?.seconds||0)-(s.lastUpdated?.seconds||0);case"oldest_updated":return(s.lastUpdated?.seconds||0)-(t.lastUpdated?.seconds||0);case"favorites":return(t.isFavorite===!0?1:0)-(s.isFavorite===!0?1:0);default:return 0}}):[],[m,r]),l=(s,t)=>{y(x=>({...x,[s]:t}))},f=()=>{y({q:"",genres:[],orderBy:"recent_updated",status:"",libraryStatus:"",year:"",season:"",type:""})},_=s=>{const t=r.genres;t.includes(s)?l("genres",t.filter(x=>x!==s)):l("genres",[...t,s])},p=r.q||r.libraryStatus||r.genres.length>0||r.year||r.season||r.type;return S?e.jsx(v,{children:e.jsxs("div",{className:"p-6 lg:p-10 max-w-[1600px] mx-auto",children:[e.jsx("div",{className:"mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4 animate-pulse",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-bg-secondary rounded-xl"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-8 w-64 bg-bg-secondary rounded-lg"}),e.jsx("div",{className:"h-5 w-96 bg-bg-secondary rounded-lg"})]})]})}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsxs("div",{className:"hidden lg:block w-72 space-y-8",children:[e.jsx("div",{className:"h-40 bg-bg-secondary rounded-2xl"}),e.jsx("div",{className:"h-20 bg-bg-secondary rounded-2xl"}),e.jsx("div",{className:"h-60 bg-bg-secondary rounded-2xl"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-16 bg-bg-secondary rounded-2xl mb-8 w-full"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6",children:[...Array(12)].map((s,t)=>e.jsx(E,{},t))})]})]})]})}):e.jsx(v,{children:e.jsxs("div",{className:"p-6 lg:p-10 max-w-[1600px] mx-auto",children:[e.jsxs("div",{className:"mb-8 border-b border-border-color pb-6 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-xl",children:e.jsx(G,{className:"w-8 h-8 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black text-text-primary mb-2 tracking-tight",children:"Minha Biblioteca"}),e.jsx("p",{className:"text-lg text-text-secondary",children:"Gerencie suas s√©ries, filmes e programe sua pr√≥xima maratona."})]})]}),e.jsxs(a.button,{onClick:L,disabled:i,whileHover:{scale:1.05},whileTap:{scale:.95},className:`flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-bold border transition-all ${i?"bg-bg-tertiary text-text-secondary border-transparent cursor-not-allowed":"bg-bg-secondary hover:bg-bg-tertiary text-text-primary border-border-color hover:border-primary/50"}`,title:"Atualizar dados de animes antigos",children:[e.jsx(q,{className:`w-4 h-4 ${i?"animate-spin":""}`}),i?"Sincronizando...":"Sincronizar Dados"]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsxs("aside",{className:I("lg:w-72 flex-shrink-0 space-y-8",A?"fixed inset-0 z-[60] bg-bg-secondary p-6 overflow-y-auto":"hidden lg:block"),children:[e.jsxs("div",{className:"flex items-center justify-between lg:hidden mb-6 border-b border-border-color pb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Filtros"}),e.jsx("button",{onClick:()=>b(!1),className:"p-2 bg-bg-tertiary rounded-full text-text-primary",children:e.jsx(j,{})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-bold text-text-secondary uppercase tracking-wider flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4 text-button-accent"})," Status"]}),e.jsx("div",{className:"flex flex-col gap-2",children:[{val:"watching",label:"Assistindo",color:"bg-primary"},{val:"completed",label:"Completos",color:"bg-blue-500"},{val:"plan_to_watch",label:"Planejo Assistir",color:"bg-gray-500"},{val:"dropped",label:"Dropados",color:"bg-red-500"},{val:"paused",label:"Pausados",color:"bg-yellow-500"}].map(s=>e.jsxs(a.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>l("libraryStatus",r.libraryStatus===s.val?"":s.val),className:`flex items-center gap-3 px-4 py-3 rounded-xl cursor-pointer transition-colors border-2 w-full text-left
                                ${r.libraryStatus===s.val?"bg-bg-secondary border-button-accent text-text-primary shadow-lg":"bg-bg-secondary/50 border-transparent hover:bg-bg-secondary hover:border-border-color text-text-secondary hover:text-text-primary"}
                            `,children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${s.color}`}),e.jsx("span",{className:"font-medium",children:s.label})]},s.val))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-bold text-text-secondary uppercase tracking-wider flex items-center gap-2",children:[e.jsx(w,{className:"w-4 h-4 text-button-accent"})," Pesquisar"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:r.q,placeholder:"Buscar na biblioteca...",className:"w-full bg-bg-secondary border-2 border-border-color rounded-xl px-4 py-3 text-base text-text-primary focus:outline-none focus:border-button-accent focus:ring-4 focus:ring-button-accent/10 transition-all placeholder-text-secondary/60",onChange:s=>l("q",s.target.value)}),r.q&&e.jsx("button",{onClick:()=>l("q",""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-secondary hover:text-text-primary p-1",children:e.jsx(j,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-bold text-text-secondary uppercase tracking-wider flex items-center gap-2",children:["  ",e.jsx(D,{className:"w-3.5 h-3.5 text-button-accent"})," Ano "]}),e.jsxs("select",{value:r.year,onChange:s=>l("year",s.target.value),className:"w-full bg-bg-secondary border-2 border-border-color rounded-xl px-2 py-2.5 text-sm text-text-primary focus:outline-none focus:border-button-accent focus:ring-2 focus:ring-button-accent/10 transition-all cursor-pointer appearance-none",children:[e.jsx("option",{value:"",children:"Todos"}),Array.from({length:45},(s,t)=>new Date().getFullYear()+1-t).map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-bold text-text-secondary uppercase tracking-wider flex items-center gap-2",children:" Temp. "}),e.jsxs("select",{value:r.season,onChange:s=>l("season",s.target.value),className:"w-full bg-bg-secondary border-2 border-border-color rounded-xl px-2 py-2.5 text-sm text-text-primary focus:outline-none focus:border-button-accent focus:ring-2 focus:ring-button-accent/10 transition-all cursor-pointer appearance-none",children:[e.jsx("option",{value:"",children:"Todas"}),e.jsx("option",{value:"winter",children:"Inverno"}),e.jsx("option",{value:"spring",children:"Primavera"}),e.jsx("option",{value:"summer",children:"Ver√£o"}),e.jsx("option",{value:"fall",children:"Outono"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-bold text-text-secondary uppercase tracking-wider flex items-center gap-2",children:[" ",e.jsx(V,{className:"w-3.5 h-3.5 text-button-accent"})," Formato "]}),e.jsxs("select",{value:r.type,onChange:s=>l("type",s.target.value),className:"w-full bg-bg-secondary border-2 border-border-color rounded-xl px-3 py-2.5 text-sm text-text-primary focus:outline-none focus:border-button-accent focus:ring-2 focus:ring-button-accent/10 transition-all cursor-pointer appearance-none",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"TV",children:"TV"}),e.jsx("option",{value:"Movie",children:"Filme"}),e.jsx("option",{value:"OVA",children:"OVA"}),e.jsx("option",{value:"Special",children:"Especial"}),e.jsx("option",{value:"ONA",children:"ONA"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-bold text-text-secondary uppercase tracking-wider flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4 text-button-accent"})," G√™neros"]}),r.genres.length>0&&e.jsx("span",{className:"text-xs bg-button-accent text-text-on-primary font-bold px-2 py-0.5 rounded-full",children:r.genres.length})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Z.map(s=>{const t=r.genres.includes(s.id);return e.jsx(a.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>_(s.id),className:`
                            text-sm px-3 py-1.5 rounded-lg border transition-colors font-medium
                            ${t?"bg-button-accent border-button-accent text-text-on-primary":"bg-bg-secondary border-border-color text-text-secondary hover:border-border-color/80 hover:text-text-primary"}
                        `,children:s.name},s.id)})})]}),p&&e.jsxs(a.button,{onClick:f,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full flex items-center justify-center gap-2 py-4 rounded-xl bg-red-500/10 border border-red-500/20 text-red-400 hover:bg-red-500/20 hover:text-red-300 transition-colors text-sm font-bold uppercase tracking-wider",children:[e.jsx(H,{className:"w-4 h-4"})," Limpar Filtros"]})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-8 p-5 bg-bg-secondary border border-border-color rounded-2xl shadow-xl shadow-shadow-color/10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>b(!0),className:"lg:hidden p-2.5 bg-button-accent text-text-on-primary rounded-lg shadow-lg shadow-button-accent/20",children:e.jsx(N,{className:"w-5 h-5"})}),e.jsxs("span",{className:"text-base text-text-secondary",children:[e.jsx("strong",{className:"text-text-primary text-lg",children:d.length})," animes na lista"]})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsxs("div",{className:"flex bg-bg-tertiary rounded-xl p-1 border border-border-color relative",children:[e.jsxs(a.button,{onClick:()=>g("grid"),className:`relative z-10 p-2 rounded-lg transition-colors ${o==="grid"?"text-button-accent":"text-text-secondary hover:text-text-primary"}`,whileTap:{scale:.9},children:[e.jsx(R,{className:"w-5 h-5"}),o==="grid"&&e.jsx(a.div,{layoutId:"viewModeBgLib",className:"absolute inset-0 bg-bg-secondary rounded-lg shadow-sm border border-border-color/50 -z-10"})]}),e.jsxs(a.button,{onClick:()=>g("list"),className:`relative z-10 p-2 rounded-lg transition-colors ${o==="list"?"text-button-accent":"text-text-secondary hover:text-text-primary"}`,whileTap:{scale:.9},children:[e.jsx(U,{className:"w-5 h-5"}),o==="list"&&e.jsx(a.div,{layoutId:"viewModeBgLib",className:"absolute inset-0 bg-bg-secondary rounded-lg shadow-sm border border-border-color/50 -z-10"})]})]}),e.jsx("span",{className:"text-sm font-medium text-text-secondary hidden sm:inline whitespace-nowrap pl-2 border-l border-border-color",children:"Ordenar por:"}),e.jsxs("div",{className:"relative w-full sm:w-auto",children:[e.jsxs("select",{className:"w-full sm:w-auto appearance-none bg-bg-tertiary border-2 border-border-color text-text-primary pl-4 pr-12 py-2.5 rounded-xl text-sm font-medium focus:outline-none focus:border-button-accent focus:ring-2 focus:ring-button-accent/20 cursor-pointer hover:bg-bg-secondary transition-colors",value:r.orderBy,onChange:s=>l("orderBy",s.target.value),children:[e.jsx("option",{value:"recent_updated",children:"üïí Editados Recentemente"}),e.jsx("option",{value:"oldest_updated",children:"ü¶ï Editados Antigos"}),e.jsx("option",{value:"score",children:"‚≠ê Minha Nota"}),e.jsx("option",{value:"title_asc",children:"üî§ T√≠tulo (A-Z)"}),e.jsx("option",{value:"title_desc",children:"üî§ T√≠tulo (Z-A)"}),e.jsx("option",{value:"favorites",children:"‚ù§Ô∏è Favoritos Primeiro"})]}),e.jsx(J,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-text-secondary pointer-events-none"})]})]})]}),e.jsx(a.div,{className:o==="grid"?"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6":"flex flex-col gap-4",variants:Y,initial:"hidden",animate:"visible",children:e.jsx(F,{mode:"popLayout",children:d.map(s=>e.jsx(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9},transition:{duration:.3},layout:!0,children:o==="grid"?e.jsx(z,{...s},`${s.id}-card`):e.jsx(P,{...s,showPersonalProgress:!0},`${s.id}-list`)},s.id))})},`${o}-${JSON.stringify(r)}-${d.length>0}`),d.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-bg-secondary rounded-full flex items-center justify-center mb-6 shadow-inner",children:e.jsx(w,{className:"w-10 h-10 text-text-secondary"})}),e.jsx("h3",{className:"text-2xl font-bold text-text-primary mb-2",children:"Nenhum anime encontrado"}),e.jsx("p",{className:"text-text-secondary mb-6",children:p?"Tente ajustar seus filtros para encontrar o que procura.":"Sua biblioteca est√° vazia. Explore o cat√°logo para adicionar animes!"}),p?e.jsx(a.button,{onClick:f,whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-6 py-3 bg-button-accent hover:bg-button-accent/90 text-text-on-primary rounded-xl font-bold transition-all shadow-lg",children:"Limpar filtros"}):e.jsx(M,{to:"/catalog",className:"px-6 py-3 bg-primary hover:bg-primary-hover text-white rounded-xl font-bold transition-all shadow-lg",children:"Ir para o Cat√°logo"})]})]})]})]})})}export{ne as Library};
